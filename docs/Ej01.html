<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Modelos Espaciales - Ejemplo 1: Modelación del rendimiento de caña de azúcar a partir de información satelital</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "Sín resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la busqueda",
    "search-hide-matches-text": "Esconder resultados adicionales",
    "search-more-match-text": "hay más resultados en este documento",
    "search-more-matches-text": "más resultados en este documento",
    "search-clear-button-title": "Borrar",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Eviar"
  }
}</script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="site_libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="site_libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Modelos Espaciales</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./slidespage.html">Slides</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Ej01.html" aria-current="page">Ejemplo 1</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Ej02.html">Ejemplo 2</a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/PPaccioretti/EstadisticaEspacial"><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 </a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#motivación" id="toc-motivación" class="nav-link active" data-scroll-target="#motivación">Motivación</a></li>
  <li><a href="#datos" id="toc-datos" class="nav-link" data-scroll-target="#datos">Datos</a>
  <ul class="collapse">
  <li><a href="#lectura-base-de-datos" id="toc-lectura-base-de-datos" class="nav-link" data-scroll-target="#lectura-base-de-datos">Lectura base de datos</a></li>
  <li><a href="#cálculos-de-índices-a-partir-de-las-bandas" id="toc-cálculos-de-índices-a-partir-de-las-bandas" class="nav-link" data-scroll-target="#cálculos-de-índices-a-partir-de-las-bandas">Cálculos de índices a partir de las bandas</a></li>
  <li><a href="#visualización-espacial-de-los-datos" id="toc-visualización-espacial-de-los-datos" class="nav-link" data-scroll-target="#visualización-espacial-de-los-datos">Visualización espacial de los datos</a></li>
  <li><a href="#estadística-descriptiva" id="toc-estadística-descriptiva" class="nav-link" data-scroll-target="#estadística-descriptiva">Estadística descriptiva</a></li>
  <li><a href="#análisis-de-regresión-lineal" id="toc-análisis-de-regresión-lineal" class="nav-link" data-scroll-target="#análisis-de-regresión-lineal">Análisis de regresión Lineal</a></li>
  <li><a href="#resumen-de-modelos-ajustados" id="toc-resumen-de-modelos-ajustados" class="nav-link" data-scroll-target="#resumen-de-modelos-ajustados">Resumen de modelos ajustados</a></li>
  </ul></li>
  <li><a href="#ajuste-espacial" id="toc-ajuste-espacial" class="nav-link" data-scroll-target="#ajuste-espacial">Ajuste espacial</a></li>
  <li><a href="#inla" id="toc-inla" class="nav-link" data-scroll-target="#inla">INLA</a>
  <ul class="collapse">
  <li><a href="#generación-grilla-espacial-y-modelo-matern-spde" id="toc-generación-grilla-espacial-y-modelo-matern-spde" class="nav-link" data-scroll-target="#generación-grilla-espacial-y-modelo-matern-spde">Generación grilla espacial y modelo Matern SPDE</a></li>
  <li><a href="#ajuste-de-mjb-con-inlabru" id="toc-ajuste-de-mjb-con-inlabru" class="nav-link" data-scroll-target="#ajuste-de-mjb-con-inlabru">Ajuste de MJB con <code>inlabru</code></a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Ejemplo 1: Modelación del rendimiento de caña de azúcar a partir de información satelital</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Código</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Enseñar el código</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Esconder el código</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">Ver el código</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="motivación" class="level2">
<h2 class="anchored" data-anchor-id="motivación">Motivación</h2>
<p>La generación de datos a partir de imágenes satelitales, constituyen una fuente valiosa de información, pudiéndose construir incluso series históricas de imagen de un sitio. En bioestadística este tipo de datos se usa para monitorear ecosistemas, realizar pronósticos climáticos y predecir cosechas, entre otros.</p>
<p>En este caso mostramos la implementación de un análisis exploratorio de datos para caracterizar la variable toneladas de caña por hectárea. Luego estudiaremos el uso de modelos de regresión lineal para estimar rendimientos de caña de azúcar a partir de índices de vegetación elaborados con información proveniente de sensores remotos.</p>
</section>
<section id="datos" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="datos">Datos</h2>
<p>Trabajamos con datos de imágenes del satélite Landsat 5 TM, seleccionadas desde: USGS (USA): <a href="http://earthexplorer.usgs.gov/" class="uri">http://earthexplorer.usgs.gov/</a> e INPE (Brasil): <a href="http://www.inpe.br/" class="uri">http://www.inpe.br/</a>.</p>
<p>Se utilizaron datos pertenecientes a lotes de producción de caña de azúcar del noroeste argentino, expresados en toneladas de caña por hectárea (TCH) por lote, correspondientes a la zafra de 2009. Se eligieron 79 lotes con fecha de cosecha posterior a la fecha de la imagen satelital y se registraron los valores de TCH y las bandas de la imagen que seria usadas para predecir esa TCH. Todas los lotes fueron cosechado en verde (i.e.&nbsp;no-quema). De cada lote se registró además la edad del cultivo ya que la caña de azúcar es una especie semiperenne y algunos lotes eran del primer año de plantación (caña planta), mientras que otros del segundo año o primer rebrote (soca1) y otros de rebrotes de 2 o más años desde la plantación (entre paréntesis figura el nombre de la variable en el archivo de datos)</p>
<ul>
<li>Unidad de análisis (UM)</li>
<li>Longitud (X_coord)<br>
</li>
<li>Latitud (Y_coord)<br>
</li>
<li>Banda 1 de la imagen satelital (Banda1)<br>
</li>
<li>Banda 2 de la imagen satelital (Banda2)<br>
</li>
<li>Banda 3 de la imagen satelital (Banda3)<br>
</li>
<li>Banda 4 de la imagen satelital (Banda4)<br>
</li>
<li>Banda 5 de la imagen satelital (Banda5)<br>
</li>
<li>Banda 7 de la imagen satelital (Banda7)<br>
</li>
<li>Edad en dos categorías: “Planta o Soca1” y “Soca2 o más” (EDAD)</li>
<li>Toneladas de caña por ha (TCH)</li>
</ul>
<section id="lectura-base-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="lectura-base-de-datos">Lectura base de datos</h3>
<div class="cell">
<details>
<summary>Carga paquetes y funciones</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>resumir_modelo <span class="ot">&lt;-</span> <span class="cf">function</span>(modelo) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(modelo) {</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">mean</span>(modelo<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelo)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> <span class="fu">BIC</span>(modelo)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  my_rmse <span class="ot">&lt;-</span> <span class="fu">rmse</span>(modelo)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  regresora <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">attr</span>(modelo<span class="sc">$</span>terms,<span class="st">"term.labels"</span>), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  conCor <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(modelo<span class="sc">$</span>modelStruct), <span class="st">'Si'</span>, <span class="st">'No'</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="st">'Indice'</span> <span class="ot">=</span> regresora,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>             <span class="st">'ConCorr'</span> <span class="ot">=</span> conCor,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>             <span class="st">'AIC'</span> <span class="ot">=</span> aic,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>             <span class="st">'BIC'</span> <span class="ot">=</span> bic,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>             <span class="st">'RMSE'</span> <span class="ot">=</span> my_rmse, </span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>diferenciaNormalizada <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> y) <span class="sc">/</span> (x <span class="sc">+</span> y)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">basemaps =</span> <span class="fu">c</span>(</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Satelital'</span> <span class="ot">=</span> leaflet<span class="sc">::</span>providers<span class="sc">$</span>Esri.WorldImagery,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="st">'OSM'</span> <span class="ot">=</span> leaflet<span class="sc">::</span>providers<span class="sc">$</span>OpenStreetMap))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/No_quemadas.txt"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cálculos-de-índices-a-partir-de-las-bandas" class="level3">
<h3 class="anchored" data-anchor-id="cálculos-de-índices-a-partir-de-las-bandas">Cálculos de índices a partir de las bandas</h3>
<ul>
<li>Índice de Vegetación de Diferencia Normalizada (Normalized Difference Vegetation Index, NDVI)</li>
</ul>
<div class="callout-noet callout callout-style-simple no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>El cálculo del NDVI se basa en la combinación de las bandas 3 (R) y 4 (NIR) de lansat ya que las plantas absorben la luz correspondiente a dichas bandas diferencialmente según su estado vegetativo.</p>
</div>
</div>
</div>
<p><span class="math display">\[NDVI = \frac{NIR - R}{NIR + R} =  \frac{B4 - B3}{B4 + B3}\]</span></p>
<ul>
<li>NDVI verde (green NDVI, gNDVI). Permite capturar más específicamente la concentración de clorofila.</li>
</ul>
<p><span class="math display">\[gNDVI = \frac{NIR - G}{NIR + G} =  \frac{B4 - B2}{B4 + B2}\]</span></p>
<ul>
<li>Índice de Canopeo Normalizado (Normalized Canopy Index, NCI), relacionado con el área foliar. Mayores valores de NCI indican menor área foliar y mayor cantidad de suelo desnudo, es decir menor canopeo.</li>
</ul>
<p><span class="math display">\[NCI = \frac{SWIR - G}{SWIR + G} =  \frac{B5 - B2}{B5 + B2}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ndvi =</span> <span class="fu">diferenciaNormalizada</span>(Banda4, Banda3),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">gndvi =</span> <span class="fu">diferenciaNormalizada</span>(Banda4, Banda2),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">nci =</span> <span class="fu">diferenciaNormalizada</span>(Banda5, Banda2)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualización-espacial-de-los-datos" class="level3">
<h3 class="anchored" data-anchor-id="visualización-espacial-de-los-datos">Visualización espacial de los datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>datos_sf <span class="ot">&lt;-</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(datos,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">'X_coord'</span>, <span class="st">'Y_coord'</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">crs =</span> <span class="dv">32720</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(datos_sf) <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">'TCH'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-b1b779db00f19ba5f4e6" style="width:100%;height:464px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-b1b779db00f19ba5f4e6">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Satelital",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OSM",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircleMarkers","args":[[-23.7464485196153,-23.8102251442079,-23.807798772785,-23.7899313294138,-23.8012069716098,-23.8053520234456,-23.8088735246686,-23.7493503925097,-23.7410416894391,-23.7478984580123,-23.772638730292,-23.7619580181205,-23.7543397724637,-23.7703658479752,-23.7700927755518,-23.7569483427717,-23.7360929931191,-23.7651047484921,-23.7565618465999,-23.7813894704031,-23.7777049366817,-23.7852732914906,-23.779028109704,-23.7635812234445,-23.7606579353086,-23.7595077679877,-23.8166120246073,-23.8138067437237,-23.8124535347487,-23.7985016948797,-23.7784826221122,-23.7852028960995,-23.7999596786218,-23.8117676431935,-23.8269796233654,-23.861023265078,-23.8389338058785,-23.850588134543,-23.8443894260765,-23.8583440038056,-23.8836467138957,-23.8505521202044,-23.8750560683318,-23.8793584110217,-23.8148547674728,-23.8449480568886,-23.8178414966536,-23.8122339779499,-23.8355362936803,-23.8366631225636,-23.8341546687368,-23.8275924546343,-23.8449137655992,-23.8478679576444,-23.8635969084832,-23.8562653636133,-23.8633916985108,-23.8598587278559,-23.8560048225759,-23.9167458994496,-23.9260904778122,-23.9344206852169,-23.8578858236607,-23.862450630589,-23.8583345872888,-23.867359244919,-23.8742729822456,-23.8696825020407,-23.9014178020162,-23.8651448564411,-23.8576371368677,-23.8290506912963,-23.8135691392768,-23.8214610842627,-23.7786200852319,-23.7520000128744,-23.7565857682783,-23.7608717089319],[-64.6905200148005,-64.6849330483639,-64.6662224489099,-64.7014149379511,-64.6939246167948,-64.6886504725855,-64.6726230068707,-64.6038916229328,-64.6557988373654,-64.5917831390908,-64.6846582163146,-64.6840689331624,-64.7147855394559,-64.7480062612885,-64.6921627808254,-64.7706238177989,-64.7240291139578,-64.7699669775411,-64.7826163798043,-64.7268430048983,-64.7142131848177,-64.6891386922463,-64.7467966822274,-64.6934989229576,-64.7090050668049,-64.6972410303497,-64.6307260612218,-64.6240274508364,-64.6312098059609,-64.6200530604147,-64.6541814372608,-64.6225909722221,-64.6417293713642,-64.620529079419,-64.6316005572463,-64.7598256838646,-64.7079297529299,-64.7514908283293,-64.7168412542412,-64.7305797211335,-64.8226221621027,-64.8020775973717,-64.7282034865677,-64.8111744575032,-64.7699646853287,-64.7750698354044,-64.757957180861,-64.8079472384968,-64.806841351374,-64.7197537461859,-64.7316253698415,-64.7585150959872,-64.7675787133592,-64.7656848747904,-64.8077021181854,-64.7699905224408,-64.7832933094586,-64.7749331278915,-64.7851890785918,-64.6996881490053,-64.7599687326364,-64.7599262119923,-64.7644931990038,-64.8020973276615,-64.7945318786945,-64.784155331355,-64.8059945572706,-64.7909150785119,-64.6730802599785,-64.7677111270063,-64.7538124097001,-64.7537800470981,-64.6147143844896,-64.7750766613322,-64.7001499392506,-64.6524590626422,-64.595133898984,-64.8761740569834],[2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619],["X6","X9","X10","X11","X12","X13","X14","X15","X16","X17","X18","X19","X20","X21","X22","X23","X24","X25","X26","X27","X28","X29","X30","X31","X32","X33","X49","X50","X51","X52","X53","X54","X55","X60","X61","X63","X64","X66","X67","X68","X71","X72","X73","X75","X76","X77","X78","X80","X81","X84","X85","X86","X87","X88","X89","X90","X91","X93","X94","X95","X97","X98","X100","X101","X102","X106","X107","X108","X109","X111","X112","X113","X115","X120","X121","X123","X125","X126"],"datos_sf",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#FFF8C4","#FEAA38","#EA6E13","#EA6E13","#FEAA38","#EA6E13","#EA6E13","#FEDE86","#FEDE86","#FEDE86","#FEAA38","#FEDE86","#FEDE86","#EA6E13","#FEAA38","#FFF8C4","#FEDE86","#EA6E13","#FEDE86","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#EA6E13","#EA6E13","#EA6E13","#EA6E13","#EA6E13","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#EA6E13","#FEDE86","#FEDE86","#B74202","#FEAA38","#FEAA38","#FEDE86","#FEAA38","#FEDE86","#FEAA38","#FEDE86","#EA6E13","#FEAA38","#FEDE86","#FEAA38","#FEAA38","#EA6E13","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#FEDE86","#FEAA38","#FEAA38","#EA6E13","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#EA6E13","#FEAA38","#FEDE86","#FEAA38","#FFF8C4","#B74202","#FEDE86","#FEDE86","#FEAA38","#FEAA38","#FEDE86","#EA6E13","#FFF8C4","#FEDE86","#FFF8C4"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},null,null,["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>45.57<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>9<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>85.30<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>10<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>105.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>11<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>111.17<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>12<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>99.96<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>13<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>104.92<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>14<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>103.25<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>15<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>67.63<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>16<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>76.23<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>17<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>71.46<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>18<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>90.77<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>19<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>61.95<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>20<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>78.93<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>21<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>106.77<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>22<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>99.65<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>23<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>58.28<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>24<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>75.20<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>25<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>102.35<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>26<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>67.04<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>27<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>91.08<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>28<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>97.80<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>29<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>90.33<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>30<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>87.27<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>31<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>83.60<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>32<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>111.19<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>33<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>118.54<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>49<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>107.73<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>50<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>109.05<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>51<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>108.52<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>52<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>98.28<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>53<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>94.41<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>54<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>90.60<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>55<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>99.01<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>60<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>92.94<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>61<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>110.01<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>63<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>69.08<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>64<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>71.38<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>66<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>128.82<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>67<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>88.65<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>68<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>87.58<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>71<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>74.98<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>72<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>88.06<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>73<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>69.42<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>75<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>84.62<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>76<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>66.93<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>77<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>102.32<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>78<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>90.04<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>80<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>73.50<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>81<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>80.03<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>84<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>96.58<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>85<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>112.77<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>86<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>80.59<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>87<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>87.39<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>88<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>88.81<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>89<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>93.23<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>90<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>76.58<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>91<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>82.85<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>93<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>91.94<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>94<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>109.90<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>95<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>98.07<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>97<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>94.94<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>98<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>83.93<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>100<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>86.13<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>101<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>111.27<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>102<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>99.81<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>106<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>73.19<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>107<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>90.02<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>108<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>58.32<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>109<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>127.49<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>111<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>63.05<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>112<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>72.67<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>113<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>80.13<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>115<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>99.70<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>120<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>72.90<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>121<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>102.49<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>123<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>45.00<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>125<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>69.89<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>126<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>TCH<\/nobr><\/td><td align=\"right\"><nobr>58.65<\/nobr><\/td><\/tr><\/table><\/div>"],null,["6","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","49","50","51","52","53","54","55","60","61","63","64","66","67","68","71","72","73","75","76","77","78","80","81","84","85","86","87","88","89","90","91","93","94","95","97","98","100","101","102","106","107","108","109","111","112","113","115","120","121","123","125","126"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#FFF8C4","#FEDE86","#FEAA38","#EA6E13","#B74202"],"labels":["40 to 60","60 to 80","80 to 100","100 to 120","120 to 140"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"TCH","extra":null,"layerId":"legend401","className":"info legend datos_sf","group":"datos_sf"}]},{"method":"addLayersControl","args":[["Satelital","OSM"],"datos_sf",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[-23.9344206852169,-23.7360929931191],"lng":[-64.8761740569834,-64.5917831390908]},"fitBounds":[-23.9344206852169,-64.8761740569834,-23.7360929931191,-64.5917831390908,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div><div class="column" style="width:2%;">

</div><div class="column" style="width:49%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(datos_sf) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">'ndvi'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-babfd0aa7ffe0bc8154d" style="width:100%;height:464px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-babfd0aa7ffe0bc8154d">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"createMapPane","args":["tmap401",401]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Satelital",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OSM",{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"pane":"tilePane"}]},{"method":"addCircleMarkers","args":[[-23.7464485196153,-23.8102251442079,-23.807798772785,-23.7899313294138,-23.8012069716098,-23.8053520234456,-23.8088735246686,-23.7493503925097,-23.7410416894391,-23.7478984580123,-23.772638730292,-23.7619580181205,-23.7543397724637,-23.7703658479752,-23.7700927755518,-23.7569483427717,-23.7360929931191,-23.7651047484921,-23.7565618465999,-23.7813894704031,-23.7777049366817,-23.7852732914906,-23.779028109704,-23.7635812234445,-23.7606579353086,-23.7595077679877,-23.8166120246073,-23.8138067437237,-23.8124535347487,-23.7985016948797,-23.7784826221122,-23.7852028960995,-23.7999596786218,-23.8117676431935,-23.8269796233654,-23.861023265078,-23.8389338058785,-23.850588134543,-23.8443894260765,-23.8583440038056,-23.8836467138957,-23.8505521202044,-23.8750560683318,-23.8793584110217,-23.8148547674728,-23.8449480568886,-23.8178414966536,-23.8122339779499,-23.8355362936803,-23.8366631225636,-23.8341546687368,-23.8275924546343,-23.8449137655992,-23.8478679576444,-23.8635969084832,-23.8562653636133,-23.8633916985108,-23.8598587278559,-23.8560048225759,-23.9167458994496,-23.9260904778122,-23.9344206852169,-23.8578858236607,-23.862450630589,-23.8583345872888,-23.867359244919,-23.8742729822456,-23.8696825020407,-23.9014178020162,-23.8651448564411,-23.8576371368677,-23.8290506912963,-23.8135691392768,-23.8214610842627,-23.7786200852319,-23.7520000128744,-23.7565857682783,-23.7608717089319],[-64.6905200148005,-64.6849330483639,-64.6662224489099,-64.7014149379511,-64.6939246167948,-64.6886504725855,-64.6726230068707,-64.6038916229328,-64.6557988373654,-64.5917831390908,-64.6846582163146,-64.6840689331624,-64.7147855394559,-64.7480062612885,-64.6921627808254,-64.7706238177989,-64.7240291139578,-64.7699669775411,-64.7826163798043,-64.7268430048983,-64.7142131848177,-64.6891386922463,-64.7467966822274,-64.6934989229576,-64.7090050668049,-64.6972410303497,-64.6307260612218,-64.6240274508364,-64.6312098059609,-64.6200530604147,-64.6541814372608,-64.6225909722221,-64.6417293713642,-64.620529079419,-64.6316005572463,-64.7598256838646,-64.7079297529299,-64.7514908283293,-64.7168412542412,-64.7305797211335,-64.8226221621027,-64.8020775973717,-64.7282034865677,-64.8111744575032,-64.7699646853287,-64.7750698354044,-64.757957180861,-64.8079472384968,-64.806841351374,-64.7197537461859,-64.7316253698415,-64.7585150959872,-64.7675787133592,-64.7656848747904,-64.8077021181854,-64.7699905224408,-64.7832933094586,-64.7749331278915,-64.7851890785918,-64.6996881490053,-64.7599687326364,-64.7599262119923,-64.7644931990038,-64.8020973276615,-64.7945318786945,-64.784155331355,-64.8059945572706,-64.7909150785119,-64.6730802599785,-64.7677111270063,-64.7538124097001,-64.7537800470981,-64.6147143844896,-64.7750766613322,-64.7001499392506,-64.6524590626422,-64.595133898984,-64.8761740569834],[2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619,2.82842712474619],["X6","X9","X10","X11","X12","X13","X14","X15","X16","X17","X18","X19","X20","X21","X22","X23","X24","X25","X26","X27","X28","X29","X30","X31","X32","X33","X49","X50","X51","X52","X53","X54","X55","X60","X61","X63","X64","X66","X67","X68","X71","X72","X73","X75","X76","X77","X78","X80","X81","X84","X85","X86","X87","X88","X89","X90","X91","X93","X94","X95","X97","X98","X100","X101","X102","X106","X107","X108","X109","X111","X112","X113","X115","X120","X121","X123","X125","X126"],"datos_sf",{"interactive":true,"className":"","pane":"tmap401","stroke":true,"color":"#666666","weight":1,"opacity":0.5,"fill":true,"fillColor":["#FEAA38","#EA6E13","#EA6E13","#EA6E13","#EA6E13","#EA6E13","#EA6E13","#FEAA38","#EA6E13","#FEDE86","#EA6E13","#FEAA38","#FEAA38","#EA6E13","#EA6E13","#FEAA38","#FEAA38","#FEAA38","#EA6E13","#FFF8C4","#EA6E13","#FEAA38","#FEAA38","#FEAA38","#EA6E13","#EA6E13","#B74202","#B74202","#EA6E13","#B74202","#EA6E13","#FEAA38","#EA6E13","#EA6E13","#B74202","#FEAA38","#FEAA38","#EA6E13","#FEDE86","#EA6E13","#EA6E13","#FEAA38","#EA6E13","#EA6E13","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#FEAA38","#EA6E13","#EA6E13","#FEAA38","#FEAA38","#EA6E13","#FEAA38","#EA6E13","#FEAA38","#EA6E13","#EA6E13","#EA6E13","#EA6E13","#EA6E13","#B74202","#EA6E13","#FEAA38","#EA6E13","#FEAA38","#FEAA38","#FEDE86","#EA6E13","#FEAA38","#EA6E13","#EA6E13","#B74202","#FEAA38","#FEAA38","#FEAA38"],"fillOpacity":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},null,null,["<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>6<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.603271<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>9<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.652006<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>10<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.658268<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>11<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.689506<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>12<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.680333<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>13<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.662676<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>14<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.663985<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>15<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.629139<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>16<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.650513<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>17<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.578470<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>18<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.684076<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>19<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.611526<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>20<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.625194<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>21<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.686955<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>22<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.651851<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>23<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.637342<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>24<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.625535<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>25<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.643137<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>26<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.676802<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>27<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.541209<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>28<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.661280<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>29<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.632011<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>30<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.626783<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>31<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.619985<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>32<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.655553<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>33<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.654941<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>49<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.707147<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>50<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.701437<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>51<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.689490<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>52<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.711772<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>53<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.670954<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>54<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.607744<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>55<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.652050<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>60<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.667793<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>61<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.709290<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>63<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.601392<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>64<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.639518<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>66<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.681595<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>67<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.599608<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>68<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.660651<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>71<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.651859<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>72<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.644226<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>73<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.664661<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>75<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.685130<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>76<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.621228<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>77<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.646093<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>78<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.629454<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>80<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.602789<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>81<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.628312<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>84<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.646897<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>85<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.667061<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>86<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.650481<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>87<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.632415<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>88<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.642969<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>89<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.659654<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>90<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.642686<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>91<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.659148<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>93<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.628180<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>94<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.665776<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>95<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.679481<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>97<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.676714<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>98<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.659465<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>100<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.652003<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>101<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.710796<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>102<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.664313<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>106<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.644144<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>107<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.658026<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>108<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.631350<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>109<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.644484<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>111<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.595193<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>112<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.655206<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>113<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.643247<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>115<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.692210<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>120<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.664421<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>121<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.704457<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>123<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.608868<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>125<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.610353<\/nobr><\/td><\/tr><\/table><\/div>","<style> div.leaflet-popup-content {width:auto !important;overflow-y:auto; overflow-x:hidden;}<\/style><div style=\"max-height:25em;padding-right:0px;\"><table>\n\t\t\t   <thead><tr><th colspan=\"2\"><b>126<\/b><\/th><\/thead><\/tr><tr><td style=\"color: #888888;\"><nobr>ndvi<\/nobr><\/td><td align=\"right\"><nobr>0.623337<\/nobr><\/td><\/tr><\/table><\/div>"],null,["6","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","49","50","51","52","53","54","55","60","61","63","64","66","67","68","71","72","73","75","76","77","78","80","81","84","85","86","87","88","89","90","91","93","94","95","97","98","100","101","102","106","107","108","109","111","112","113","115","120","121","123","125","126"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#FFF8C4","#FEDE86","#FEAA38","#EA6E13","#B74202"],"labels":["0.50 to 0.55","0.55 to 0.60","0.60 to 0.65","0.65 to 0.70","0.70 to 0.75"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"unknown","title":"ndvi","extra":null,"layerId":"legend401","className":"info legend datos_sf","group":"datos_sf"}]},{"method":"addLayersControl","args":[["Satelital","OSM"],"datos_sf",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]}],"limits":{"lat":[-23.9344206852169,-23.7360929931191],"lng":[-64.8761740569834,-64.5917831390908]},"fitBounds":[-23.9344206852169,-64.8761740569834,-23.7360929931191,-64.5917831390908,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</section>
<section id="estadística-descriptiva" class="level3">
<h3 class="anchored" data-anchor-id="estadística-descriptiva">Estadística descriptiva</h3>
<section id="gráficos" class="level4">
<h4 class="anchored" data-anchor-id="gráficos">Gráficos</h4>
<div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(TCH)) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count))),</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Frecuencia Relativa'</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(EDAD, TCH)) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.25</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ej01_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Histograma</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ej01_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Gráfico de cajas</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="análisis-de-regresión-lineal" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="análisis-de-regresión-lineal">Análisis de regresión Lineal</h3>
<section id="ndvi" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="ndvi">NDVI</h4>

<div class="no-row-height column-margin column-container"><div class="">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(ndvi, TCH)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-ndvi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Ej01_files/figure-html/fig-ndvi-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;1: TCH en función de NDVI</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>modelo_ndvi <span class="ot">&lt;-</span> <span class="fu">gls</span>(TCH <span class="sc">~</span> ndvi, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> datos, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_ndvi)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Generalized least squares fit by REML
##   Model: TCH ~ ndvi 
##   Data: datos 
##        AIC     BIC    logLik
##   630.4788 637.471 -312.2394
## 
## Coefficients:
##                 Value Std.Error   t-value p-value
## (Intercept) -116.3873  33.64212 -3.459570   9e-04
## ndvi         314.9360  51.70535  6.090974   0e+00
## 
##  Correlation: 
##      (Intr)
## ndvi -0.999
## 
## Standardized residuals:
##         Min          Q1         Med          Q3         Max 
## -2.08695971 -0.57298217 -0.01604275  0.55538562  2.81179426 
## 
## Residual standard error: 14.54863 
## Degrees of freedom: 78 total; 76 residual</code></pre>
</div>
</div>
</section>
<section id="gndvi" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="gndvi">gNDVI</h4>

<div class="no-row-height column-margin column-container"><div class="">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(gndvi, TCH)) <span class="sc">+</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-gndvi" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Ej01_files/figure-html/fig-gndvi-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;2: TCH en función de gNDVI</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>modelo_gndvi <span class="ot">&lt;-</span> <span class="fu">gls</span>(TCH <span class="sc">~</span> gndvi, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> datos, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_gndvi)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Generalized least squares fit by REML
##   Model: TCH ~ gndvi 
##   Data: datos 
##        AIC      BIC    logLik
##   629.1229 636.1151 -311.5614
## 
## Coefficients:
##                 Value Std.Error   t-value p-value
## (Intercept) -165.8848  41.21302 -4.025058   1e-04
## gndvi        448.9050  72.73257  6.171994   0e+00
## 
##  Correlation: 
##       (Intr)
## gndvi -0.999
## 
## Standardized residuals:
##           Min            Q1           Med            Q3           Max 
## -2.0868227416 -0.4850732735  0.0006377955  0.5531917024  2.8270446735 
## 
## Residual standard error: 14.48515 
## Degrees of freedom: 78 total; 76 residual</code></pre>
</div>
</div>
</section>
<section id="nci" class="level4 page-columns page-full">
<h4 class="anchored" data-anchor-id="nci">NCI</h4>

<div class="no-row-height column-margin column-container"><div class="">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(nci, TCH)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-nci" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Ej01_files/figure-html/fig-nci-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figura&nbsp;3: TCH en función de NCI</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div></div><div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>modelo_nci <span class="ot">&lt;-</span>  <span class="fu">gls</span>(TCH <span class="sc">~</span> nci, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> datos, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_nci)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Generalized least squares fit by REML
##   Model: TCH ~ nci 
##   Data: datos 
##        AIC      BIC   logLik
##   638.6299 645.6221 -316.315
## 
## Coefficients:
##                 Value Std.Error   t-value p-value
## (Intercept)  275.5376  38.31946  7.190539       0
## nci         -504.6346 103.15799 -4.891861       0
## 
##  Correlation: 
##     (Intr)
## nci -0.999
## 
## Standardized residuals:
##          Min           Q1          Med           Q3          Max 
## -2.273389964 -0.534774349 -0.004252205  0.635330715  2.195348983 
## 
## Residual standard error: 15.47764 
## Degrees of freedom: 78 total; 76 residual</code></pre>
</div>
</div>
</section>
</section>
<section id="resumen-de-modelos-ajustados" class="level3">
<h3 class="anchored" data-anchor-id="resumen-de-modelos-ajustados">Resumen de modelos ajustados</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_ndvi),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_gndvi),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_nci)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Indice</th>
<th style="text-align: left;">ConCorr</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ndvi</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">630.4788</td>
<td style="text-align: right;">637.4710</td>
<td style="text-align: right;">14.36090</td>
</tr>
<tr class="even">
<td style="text-align: left;">gndvi</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">629.1229</td>
<td style="text-align: right;">636.1151</td>
<td style="text-align: right;">14.29823</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nci</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">638.6299</td>
<td style="text-align: right;">645.6221</td>
<td style="text-align: right;">15.27792</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="ajuste-espacial" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="ajuste-espacial">Ajuste espacial</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>modelo_ndvi_conCorr <span class="ot">&lt;-</span> <span class="fu">gls</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  TCH <span class="sc">~</span> ndvi,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corExp</span>(</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">form =</span>  <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X_coord)) <span class="sc">+</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Y_coord)),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> <span class="cn">FALSE</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">'REML'</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_ndvi_conCorr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Generalized least squares fit by REML
##   Model: TCH ~ ndvi 
##   Data: datos 
##        AIC      BIC    logLik
##   627.2496 636.5725 -309.6248
## 
## Correlation Structure: Exponential spatial correlation
##  Formula: ~as.numeric(as.character(X_coord)) + as.numeric(as.character(Y_coord)) 
##  Parameter estimate(s):
##    range 
## 1229.264 
## 
## Coefficients:
##                 Value Std.Error   t-value p-value
## (Intercept) -99.12808  35.03923 -2.829060   0.006
## ndvi        285.90429  54.01696  5.292862   0.000
## 
##  Correlation: 
##      (Intr)
## ndvi -0.997
## 
## Standardized residuals:
##         Min          Q1         Med          Q3         Max 
## -1.87668595 -0.40251825  0.08934825  0.64328353  2.65467052 
## 
## Residual standard error: 15.95641 
## Degrees of freedom: 78 total; 76 residual</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>modelo_gndvi_conCorr <span class="ot">&lt;-</span> <span class="fu">gls</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  TCH <span class="sc">~</span> gndvi,</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corExp</span>(</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">form =</span>  <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X_coord)) <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Y_coord)),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> <span class="cn">FALSE</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">'REML'</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_gndvi_conCorr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Generalized least squares fit by REML
##   Model: TCH ~ gndvi 
##   Data: datos 
##        AIC      BIC    logLik
##   623.8545 633.1774 -307.9273
## 
## Correlation Structure: Exponential spatial correlation
##  Formula: ~as.numeric(as.character(X_coord)) + as.numeric(as.character(Y_coord)) 
##  Parameter estimate(s):
##    range 
## 1339.352 
## 
## Coefficients:
##                 Value Std.Error   t-value p-value
## (Intercept) -154.9457  42.98948 -3.604269   6e-04
## gndvi        425.7714  75.95467  5.605598   0e+00
## 
##  Correlation: 
##       (Intr)
## gndvi -0.998
## 
## Standardized residuals:
##        Min         Q1        Med         Q3        Max 
## -1.7304645 -0.2923111  0.1405291  0.6403081  2.6966424 
## 
## Residual standard error: 15.95296 
## Degrees of freedom: 78 total; 76 residual</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>modelo_nci_conCorr <span class="ot">&lt;-</span> <span class="fu">gls</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  TCH <span class="sc">~</span> nci,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corExp</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">form =</span>  <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X_coord)) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Y_coord)),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> <span class="cn">FALSE</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">'REML'</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_nci_conCorr)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## Generalized least squares fit by REML
##   Model: TCH ~ nci 
##   Data: datos 
##        AIC      BIC    logLik
##   636.5002 645.8232 -314.2501
## 
## Correlation Structure: Exponential spatial correlation
##  Formula: ~as.numeric(as.character(X_coord)) + as.numeric(as.character(Y_coord)) 
##  Parameter estimate(s):
##    range 
## 791.3094 
## 
## Coefficients:
##                 Value Std.Error   t-value p-value
## (Intercept)  257.4790  40.85657  6.302023   0e+00
## nci         -457.4087 109.32719 -4.183851   1e-04
## 
##  Correlation: 
##     (Intr)
## nci -0.998
## 
## Standardized residuals:
##        Min         Q1        Med         Q3        Max 
## -2.1177676 -0.5221233  0.0235839  0.6875554  2.1389684 
## 
## Residual standard error: 15.97278 
## Degrees of freedom: 78 total; 76 residual</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_ndvi),</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_ndvi_conCorr),</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_gndvi),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_gndvi_conCorr),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_nci),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_nci_conCorr)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="kable-table">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">Indice</th>
<th style="text-align: left;">ConCorr</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
<th style="text-align: right;">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ndvi</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">630.4788</td>
<td style="text-align: right;">637.4710</td>
<td style="text-align: right;">14.36090</td>
</tr>
<tr class="even">
<td style="text-align: left;">ndvi</td>
<td style="text-align: left;">Si</td>
<td style="text-align: right;">627.2496</td>
<td style="text-align: right;">636.5725</td>
<td style="text-align: right;">14.48017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">gndvi</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">629.1229</td>
<td style="text-align: right;">636.1151</td>
<td style="text-align: right;">14.29823</td>
</tr>
<tr class="even">
<td style="text-align: left;">gndvi</td>
<td style="text-align: left;">Si</td>
<td style="text-align: right;">623.8545</td>
<td style="text-align: right;">633.1774</td>
<td style="text-align: right;">14.46971</td>
</tr>
<tr class="odd">
<td style="text-align: left;">nci</td>
<td style="text-align: left;">No</td>
<td style="text-align: right;">638.6299</td>
<td style="text-align: right;">645.6221</td>
<td style="text-align: right;">15.27792</td>
</tr>
<tr class="even">
<td style="text-align: left;">nci</td>
<td style="text-align: left;">Si</td>
<td style="text-align: right;">636.5002</td>
<td style="text-align: right;">645.8232</td>
<td style="text-align: right;">15.30830</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ef_fijos_ndvo_iid <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_ndvi)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ef_fijos_ndvo_iid<span class="sc">$</span>tTable</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##                 Value Std.Error   t-value      p-value
## (Intercept) -116.3873  33.64212 -3.459570 8.903363e-04
## ndvi         314.9360  51.70535  6.090974 4.273028e-08</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ef_fijos_ndvo_corr <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_ndvi_conCorr)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>ef_fijos_ndvo_corr<span class="sc">$</span>tTable</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##                 Value Std.Error   t-value      p-value
## (Intercept) -99.12808  35.03923 -2.829060 5.967466e-03
## ndvi        285.90429  54.01696  5.292862 1.128048e-06</code></pre>
</div>
</div>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>predichos_lm <span class="ot">&lt;-</span> datos</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>predichos_lm<span class="sc">$</span>pred_ndvi_iid <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_ndvi)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>predichos_lm<span class="sc">$</span>pred_ndvi_esp <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_ndvi_conCorr)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_iid, TCH)) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_esp, TCH)) <span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_esp, pred_ndvi_iid)) <span class="sc">+</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell column-page quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Ej01_files/figure-html/obs-pred-lm-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Ej01_files/figure-html/obs-pred-lm-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="Ej01_files/figure-html/obs-pred-lm-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</section>
<section id="inla" class="level1 page-columns page-full">
<h1>INLA</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!requireNamespace("BiocManager", quietly = TRUE))</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   install.packages("BiocManager")</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># BiocManager::install(c("graph", "Rgraphviz"), dep = TRUE)</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   "INLA",</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   repos = c(getOption("repos"), INLA = "https://inla.r-inla-download.org/R/testing"),</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   dep = TRUE</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.r-inla.org/download-install</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(INLA)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inlabru)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inla.setOption</span>(<span class="at">inla.mode =</span> <span class="st">'experimental'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="generación-grilla-espacial-y-modelo-matern-spde" class="level3">
<h3 class="anchored" data-anchor-id="generación-grilla-espacial-y-modelo-matern-spde">Generación grilla espacial y modelo Matern SPDE</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(datos_sf)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>mesh <span class="ot">&lt;-</span> INLA<span class="sc">::</span><span class="fu">inla.mesh.2d</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">loc =</span> loc,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">offset =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">4000</span>),</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">800</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">max.edge =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">max.n =</span> <span class="dv">10000</span>)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_sf) <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg</span>(mesh) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ej01_files/figure-html/generacion-grilla-inla-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>spde <span class="ot">&lt;-</span> INLA<span class="sc">::</span><span class="fu">inla.spde2.pcmatern</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mesh =</span> mesh,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior.range =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="fl">0.05</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior.sigma =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="fl">0.01</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Ajuste MJB usando INLA sin funciones de inlabru</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>proj_obs <span class="ot">&lt;-</span> <span class="fu">inla.mesh.projector</span>(mesh, <span class="at">loc =</span> loc)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>proj_pred <span class="ot">&lt;-</span> <span class="fu">inla.mesh.projector</span>(mesh, <span class="at">loc =</span> mesh<span class="sc">$</span>loc)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>A_obs <span class="ot">&lt;-</span> <span class="fu">inla.spde.make.A</span>(mesh, <span class="at">loc =</span> loc)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>A_pred <span class="ot">&lt;-</span> <span class="fu">inla.spde.make.A</span>(mesh, <span class="at">loc =</span> proj_pred<span class="sc">$</span>loc)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>spde<span class="sc">$</span>n.spde</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>stack_obs <span class="ot">&lt;-</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inla.stack</span>(</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">list</span>(<span class="at">y =</span> datos_sf<span class="sc">$</span>TCH),</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="fu">list</span>(A_obs, <span class="dv">1</span>),</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">effects =</span> <span class="fu">list</span>(<span class="fu">c</span>(</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">1</span>),</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inla.spde.make.index</span>(<span class="st">"spatial"</span>, spde<span class="sc">$</span>n.spde)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">covar =</span> datos_sf<span class="sc">$</span>ndvi),</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag =</span> <span class="st">"obs"</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>stack_pred <span class="ot">&lt;-</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inla.stack</span>(</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">list</span>(<span class="at">y =</span> <span class="cn">NA</span>),</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="fu">list</span>(A_pred),</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">effects =</span> <span class="fu">list</span>(<span class="fu">c</span>(</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">1</span>),</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inla.spde.make.index</span>(<span class="st">"spatial"</span>, mesh<span class="sc">$</span>n)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag =</span> <span class="st">"pred"</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>stack <span class="ot">&lt;-</span> <span class="fu">inla.stack</span>(stack_obs, stack_pred)</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> Intercept <span class="sc">+</span> covar <span class="sc">+</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">f</span>(spatial, <span class="at">model =</span> spde)</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">inla</span>(</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>  formula,</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">inla.stack.data</span>(stack_obs, <span class="at">spde =</span> spde),</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="fu">inla.stack.A</span>(stack_obs),</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">compute =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result1)</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos_sf<span class="sc">$</span>TCH, </span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>     result1<span class="sc">$</span>summary.fitted.values[<span class="fu">inla.stack.index</span>(stack_obs, <span class="st">"obs"</span>)<span class="sc">$</span>data, <span class="st">"mean"</span>],</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Observations vs posterior predicted values at the data locations"</span>)</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a><span class="co"># field_pred &lt;- inla.mesh.project(proj_pred,</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 result1$summary.fitted.values[inla.stack.index(stack, "pred")$data, "mean"])</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a><span class="co"># field_pred_sd &lt;- inla.mesh.project(proj_pred,</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    result1$summary.fitted.values[inla.stack.index(stack, "pred")$data, "sd"])</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a><span class="co"># image(inla.mesh.project(mesh,</span></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a><span class="co">#                         field = field_pred,</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="co">#                         dims = c(200, 200)),</span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a><span class="co">#       main = "Posterior field mean")</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="co"># image(inla.mesh.project(mesh,</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a><span class="co">#                         field = field_pred_sd,</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a><span class="co">#                         dims = c(200, 200)),</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a><span class="co">#       main = "Prediction standard deviation")</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ajuste-de-mjb-con-inlabru" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="ajuste-de-mjb-con-inlabru">Ajuste de MJB con <code>inlabru</code></h2>
<p>El paquete <code>inlabru</code> fue desarrollado para facilitar la modelación espacial utilizando funciones del paquete <code>INLA</code>.</p>
<div class="cell column-page-right" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ndvi_bru_spde <span class="ot">&lt;-</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bru</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    TCH <span class="sc">~</span> <span class="fu">Intercept</span>(<span class="dv">1</span>) <span class="sc">+</span> ndvi <span class="sc">+</span> <span class="fu">site</span>(<span class="at">main =</span> coordinates, <span class="at">model =</span> spde),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">as_Spatial</span>(datos_sf)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ndvi_bru_spde)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>## inlabru version: 2.5.3
## INLA version: 22.10.15-1
## Components:
##   Intercept: Model types main='linear', group='exchangeable', replicate='iid'
##   ndvi: Model types main='linear', group='exchangeable', replicate='iid'
##   site: Model types main='spde', group='exchangeable', replicate='iid'
## Likelihoods:
##   Family: 'gaussian'
##     Data class: 'SpatialPointsDataFrame'
##     Predictor: TCH ~ .
## Time used:
##     Pre = 2.64, Running = 4.36, Post = 0.258, Total = 7.26 
## Fixed effects:
##             mean     sd 0.025quant 0.5quant 0.975quant   mode kld
## Intercept 31.298 16.663     -1.334   31.276     64.047 31.231   0
## ndvi      79.801 24.893     30.758   79.881    128.397 80.043   0
## 
## Random effects:
##   Name     Model
##     site SPDE2 model
## 
## Model hyperparameters:
##                                             mean       sd 0.025quant 0.5quant
## Precision for the Gaussian observations    0.011    0.005      0.005    0.011
## Range for site                          6827.928 3239.781   2608.525 6146.314
## Stdev for site                            16.247    3.602     10.216   15.895
##                                         0.975quant     mode
## Precision for the Gaussian observations   2.30e-02    0.009
## Range for site                            1.51e+04 5005.853
## Stdev for site                            2.43e+01   15.241
## 
## Deviance Information Criterion (DIC) ...............: 615.48
## Deviance Information Criterion (DIC, saturated) ....: 14385.92
## Effective number of parameters .....................: 37.10
## 
## Watanabe-Akaike information criterion (WAIC) ...: 620.13
## Effective number of parameters .................: 32.96
## 
## Marginal log-Likelihood:  -346.58 
##  is computed 
## Posterior summaries for the linear predictor and the fitted values are computed
## (Posterior marginals needs also 'control.compute=list(return.marginals.predictor=TRUE)')</code></pre>
</div>
</div>
<div class="page-columns page-full">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ndvi_bru_spde, <span class="st">"Intercept"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ndvi_bru_spde, <span class="st">"ndvi"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell column-screen-inset-shaded quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Ej01_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="Ej01_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
<ul>
<li>Distribución a posteriori de los hiperparámetros</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"matern.covariance"</span>) <span class="ot">-&gt;</span> covplot</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"matern.correlation"</span>) <span class="ot">-&gt;</span> corplot</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"range"</span>) <span class="ot">-&gt;</span> rngplot</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"log.range"</span>) <span class="ot">-&gt;</span> lgrngplot</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"variance"</span>) <span class="ot">-&gt;</span> varplot</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"log.variance"</span>) <span class="ot">-&gt;</span> lgvarplot</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(<span class="fu">plot</span>(covplot), <span class="fu">plot</span>(corplot),</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot</span>(rngplot), <span class="fu">plot</span>(lgrngplot),</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot</span>(varplot), <span class="fu">plot</span>(lgvarplot))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ej01_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="observados-vs.-distribución-a-posteriori" class="level4">
<h4 class="anchored" data-anchor-id="observados-vs.-distribución-a-posteriori">Observados vs.&nbsp;distribución a posteriori</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>pred_mesh <span class="ot">&lt;-</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(ndvi_bru_spde, <span class="fu">as_Spatial</span>(datos_sf), <span class="sc">~</span> Intercept <span class="sc">+</span> ndvi <span class="sc">+</span> site)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>predichos <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(pred_mesh)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos, <span class="fu">aes</span>(mean, TCH)) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ej01_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Predicción espacial de TCH</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># No aplica para esta aplicación.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_mesh &lt;-</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   predict(ndvi_bru_spde, pixels(mesh), ~ Intercept + ndvi + site)</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   gg(pred_mesh)</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(datos_sf) +</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   gg(pred_mesh) +</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">#   gg(mesh) +</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf()</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>predichos_lm<span class="sc">$</span>pred_ndvi_inla <span class="ot">&lt;-</span> predichos<span class="sc">$</span>mean</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_iid, TCH)) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ej01_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_esp, TCH)) <span class="sc">+</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ej01_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> predichos_lm, </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(pred_ndvi_iid, TCH, <span class="at">color =</span> <span class="st">'REML iid'</span>)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> predichos_lm, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(pred_ndvi_esp, TCH, <span class="at">color =</span> <span class="st">'REML Corr'</span>)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> predichos_lm, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(pred_ndvi_inla, TCH, <span class="at">color =</span> <span class="st">'INLA Corr'</span>)) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'TCH Predichos'</span>, <span class="at">y =</span> <span class="st">'TCH Observado'</span>, <span class="at">color =</span> <span class="st">'Estimación'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ej01_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Correr el código</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Ejemplo 1: Modelación del rendimiento de caña de azúcar a partir de información satelital"</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">## Motivación </span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>La generación de datos a partir de imágenes satelitales, constituyen una fuente </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>valiosa de información, pudiéndose construir incluso series históricas de </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>imagen de un sitio. En bioestadística este tipo de datos se usa para monitorear </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>ecosistemas, realizar pronósticos climáticos y predecir cosechas, entre otros.</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>En este caso mostramos la implementación de un análisis exploratorio de datos </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>para caracterizar la variable toneladas de caña por hectárea. </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>Luego estudiaremos el uso de modelos de regresión lineal para estimar </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>rendimientos de caña de azúcar a partir de índices de vegetación elaborados </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>con información proveniente de sensores remotos.</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Datos</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>Trabajamos con datos de imágenes del satélite Landsat 5 TM, </span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>seleccionadas desde: USGS (USA): <span class="ot">&lt;http://earthexplorer.usgs.gov/&gt;</span> e </span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>INPE (Brasil): <span class="ot">&lt;http://www.inpe.br/&gt;</span>.</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>Se utilizaron datos pertenecientes a lotes de producción de caña de azúcar </span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>del noroeste argentino, expresados en toneladas de caña por hectárea (TCH) </span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>por lote, correspondientes a la zafra de 2009. Se eligieron 79 lotes con fecha </span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>de cosecha posterior a la fecha de la imagen satelital y se registraron los </span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a>valores de TCH y las bandas de la imagen que seria usadas para predecir esa </span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a>TCH. Todas los lotes fueron cosechado en verde (i.e. no-quema). De cada lote </span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a>se registró además la edad del cultivo ya que la caña de azúcar es una especie </span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a>semiperenne y algunos lotes eran del primer año de plantación (caña planta), </span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>mientras que otros del segundo año o primer rebrote (soca1) y otros de </span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>rebrotes de 2 o más años desde la plantación (entre paréntesis figura el nombre </span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>de la variable en el archivo de datos)</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Unidad de análisis (UM)</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Longitud (X_coord)      </span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Latitud (Y_coord)      </span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Banda 1 de la imagen satelital (Banda1)      </span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Banda 2 de la imagen satelital (Banda2)        </span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Banda 3 de la imagen satelital (Banda3)      </span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Banda 4 de la imagen satelital (Banda4)         </span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Banda 5 de la imagen satelital (Banda5)      </span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Banda 7 de la imagen satelital (Banda7)      </span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Edad en dos categorías: "Planta o Soca1" y "Soca2 o más" (EDAD)</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Toneladas de caña por ha (TCH)             </span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="fu">### Lectura base de datos</span></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Carga paquetes y funciones"</span></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a>resumir_modelo <span class="ot">&lt;-</span> <span class="cf">function</span>(modelo) {</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a>  rmse <span class="ot">&lt;-</span> <span class="cf">function</span>(modelo) {</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="fu">mean</span>(modelo<span class="sc">$</span>residuals<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a>  aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(modelo)</span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a>  bic <span class="ot">&lt;-</span> <span class="fu">BIC</span>(modelo)</span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a>  my_rmse <span class="ot">&lt;-</span> <span class="fu">rmse</span>(modelo)</span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a>  regresora <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">attr</span>(modelo<span class="sc">$</span>terms,<span class="st">"term.labels"</span>), <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a>  conCor <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">length</span>(modelo<span class="sc">$</span>modelStruct), <span class="st">'Si'</span>, <span class="st">'No'</span>)</span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="st">'Indice'</span> <span class="ot">=</span> regresora,</span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a>             <span class="st">'ConCorr'</span> <span class="ot">=</span> conCor,</span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a>             <span class="st">'AIC'</span> <span class="ot">=</span> aic,</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a>             <span class="st">'BIC'</span> <span class="ot">=</span> bic,</span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a>             <span class="st">'RMSE'</span> <span class="ot">=</span> my_rmse, </span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a>             <span class="at">check.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a>diferenciaNormalizada <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a>  (x <span class="sc">-</span> y) <span class="sc">/</span> (x <span class="sc">+</span> y)</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_options</span>(<span class="at">basemaps =</span> <span class="fu">c</span>(</span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Satelital'</span> <span class="ot">=</span> leaflet<span class="sc">::</span>providers<span class="sc">$</span>Esri.WorldImagery,</span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>  <span class="st">'OSM'</span> <span class="ot">=</span> leaflet<span class="sc">::</span>providers<span class="sc">$</span>OpenStreetMap))</span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/No_quemadas.txt"</span>)</span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="fu">### Cálculos de índices a partir de las bandas</span></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a><span class="ss">-  </span>Índice de Vegetación de Diferencia Normalizada (Normalized Difference </span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a>Vegetation Index, NDVI)</span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a>::: {.callout-noet appearance="simple"}</span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a>El cálculo del NDVI se basa en la combinación de las bandas 3 (R) y 4 (NIR) de</span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a>lansat ya que las plantas absorben la luz correspondiente a dichas bandas </span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a>diferencialmente según su estado vegetativo.</span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a>$$NDVI = \frac{NIR - R}{NIR + R} =  \frac{B4 - B3}{B4 + B3}$$</span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>NDVI verde (green NDVI, gNDVI). Permite capturar más específicamente la </span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a>concentración de clorofila. </span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a>$$gNDVI = \frac{NIR - G}{NIR + G} =  \frac{B4 - B2}{B4 + B2}$$</span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Índice de Canopeo Normalizado (Normalized Canopy Index, NCI), </span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a>relacionado con el área foliar. Mayores valores de NCI indican menor área foliar</span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a>y mayor cantidad de suelo desnudo, es decir menor canopeo.</span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a>$$NCI = \frac{SWIR - G}{SWIR + G} =  \frac{B5 - B2}{B5 + B2}$$</span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">|&gt;</span> </span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">ndvi =</span> <span class="fu">diferenciaNormalizada</span>(Banda4, Banda3),</span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a>    <span class="at">gndvi =</span> <span class="fu">diferenciaNormalizada</span>(Banda4, Banda2),</span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a>    <span class="at">nci =</span> <span class="fu">diferenciaNormalizada</span>(Banda5, Banda2)</span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualización espacial de los datos</span></span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a>datos_sf <span class="ot">&lt;-</span></span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_as_sf</span>(datos,</span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a>               <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">'X_coord'</span>, <span class="st">'Y_coord'</span>),</span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a>               <span class="at">crs =</span> <span class="dv">32720</span>)</span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">'view'</span>)</span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a>:::: {.columns}</span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a>::: {.column width="49%"}</span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(datos_sf) <span class="sc">+</span></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">'TCH'</span>)</span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a>::: {.column width="2%"}</span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a>::: {.column width="49%"}</span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(datos_sf) <span class="sc">+</span></span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">'ndvi'</span>)</span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a>::::</span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estadística descriptiva</span></span>
<span id="cb44-198"><a href="#cb44-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gráficos</span></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap: ["Histograma", "Gráfico de cajas"]</span></span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(TCH)) <span class="sc">+</span></span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count))),</span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bins =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">'Frecuencia Relativa'</span>)</span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(EDAD, TCH)) <span class="sc">+</span></span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.25</span>)</span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Análisis de regresión Lineal</span></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a><span class="fu">#### NDVI</span></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb44-224"><a href="#cb44-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-ndvi</span></span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "TCH en función de NDVI"</span></span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(ndvi, TCH)) <span class="sc">+</span></span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-237"><a href="#cb44-237" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-238"><a href="#cb44-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a>modelo_ndvi <span class="ot">&lt;-</span> <span class="fu">gls</span>(TCH <span class="sc">~</span> ndvi, </span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> datos, </span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_ndvi)</span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=FALSE,purl=FALSE}</span></span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a><span class="co"># modelo_ndvi_gls_ml &lt;- nlme::gls(TCH ~ ndvi, data = datos, method = "ML")</span></span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a><span class="co"># modelo_ndvi_gls_reml &lt;- nlme::gls(TCH ~ ndvi, data = datos, method = "REML")</span></span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a><span class="fu">#### gNDVI</span></span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-gndvi</span></span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "TCH en función de gNDVI"</span></span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(gndvi, TCH)) <span class="sc">+</span></span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a>modelo_gndvi <span class="ot">&lt;-</span> <span class="fu">gls</span>(TCH <span class="sc">~</span> gndvi, </span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> datos, </span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb44-280"><a href="#cb44-280" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_gndvi)</span>
<span id="cb44-281"><a href="#cb44-281" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a><span class="fu">#### NCI </span></span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a>::: {.column-margin}</span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-290"><a href="#cb44-290" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-nci</span></span>
<span id="cb44-291"><a href="#cb44-291" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "TCH en función de NCI"</span></span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: margin</span></span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(nci, TCH)) <span class="sc">+</span></span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-298"><a href="#cb44-298" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a>modelo_nci <span class="ot">&lt;-</span>  <span class="fu">gls</span>(TCH <span class="sc">~</span> nci, </span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> datos, </span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">'REML'</span>)</span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_nci)</span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a><span class="fu">### Resumen de modelos ajustados</span></span>
<span id="cb44-311"><a href="#cb44-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_ndvi),</span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_gndvi),</span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_nci)</span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajuste espacial</span></span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: modelo-corr-ndvi</span></span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a>modelo_ndvi_conCorr <span class="ot">&lt;-</span> <span class="fu">gls</span>(</span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a>  TCH <span class="sc">~</span> ndvi,</span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corExp</span>(</span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a>    <span class="at">form =</span>  <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X_coord)) <span class="sc">+</span> </span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Y_coord)),</span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> <span class="cn">FALSE</span></span>
<span id="cb44-338"><a href="#cb44-338" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos,</span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">'REML'</span></span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_ndvi_conCorr)</span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: modelo-corr-gndvi</span></span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a>modelo_gndvi_conCorr <span class="ot">&lt;-</span> <span class="fu">gls</span>(</span>
<span id="cb44-352"><a href="#cb44-352" aria-hidden="true" tabindex="-1"></a>  TCH <span class="sc">~</span> gndvi,</span>
<span id="cb44-353"><a href="#cb44-353" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corExp</span>(</span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">form =</span>  <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X_coord)) <span class="sc">+</span> </span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Y_coord)),</span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> <span class="cn">FALSE</span></span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos,</span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">'REML'</span></span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_gndvi_conCorr)</span>
<span id="cb44-363"><a href="#cb44-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-369"><a href="#cb44-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: modelo-corr-nci</span></span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a>modelo_nci_conCorr <span class="ot">&lt;-</span> <span class="fu">gls</span>(</span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a>  TCH <span class="sc">~</span> nci,</span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a>  <span class="at">correlation =</span> <span class="fu">corExp</span>(</span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a>    <span class="at">form =</span>  <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(X_coord)) <span class="sc">+</span></span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>(<span class="fu">as.character</span>(Y_coord)),</span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"euclidean"</span>,</span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a>    <span class="at">nugget =</span> <span class="cn">FALSE</span></span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datos,</span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">'REML'</span></span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-382"><a href="#cb44-382" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_nci_conCorr)</span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-386"><a href="#cb44-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(</span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_ndvi),</span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_ndvi_conCorr),</span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_gndvi),</span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_gndvi_conCorr),</span>
<span id="cb44-395"><a href="#cb44-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_nci),</span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">resumir_modelo</span>(modelo_nci_conCorr)</span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-399"><a href="#cb44-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a>ef_fijos_ndvo_iid <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_ndvi)</span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a>ef_fijos_ndvo_iid<span class="sc">$</span>tTable</span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a>ef_fijos_ndvo_corr <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo_ndvi_conCorr)</span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a>ef_fijos_ndvo_corr<span class="sc">$</span>tTable</span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{r obs-pred-lm}</span></span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page</span></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 3</span></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 1</span></span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a>predichos_lm <span class="ot">&lt;-</span> datos</span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a>predichos_lm<span class="sc">$</span>pred_ndvi_iid <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_ndvi)</span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a>predichos_lm<span class="sc">$</span>pred_ndvi_esp <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo_ndvi_conCorr)</span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_iid, TCH)) <span class="sc">+</span></span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_esp, TCH)) <span class="sc">+</span></span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_esp, pred_ndvi_iid)) <span class="sc">+</span></span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a><span class="fu"># INLA</span></span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a><span class="co"># if (!requireNamespace("BiocManager", quietly = TRUE))</span></span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a><span class="co">#   install.packages("BiocManager")</span></span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a><span class="co"># BiocManager::install(c("graph", "Rgraphviz"), dep = TRUE)</span></span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(</span></span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a><span class="co">#   "INLA",</span></span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a><span class="co">#   repos = c(getOption("repos"), INLA = "https://inla.r-inla-download.org/R/testing"),</span></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a><span class="co">#   dep = TRUE</span></span>
<span id="cb44-454"><a href="#cb44-454" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb44-455"><a href="#cb44-455" aria-hidden="true" tabindex="-1"></a><span class="co"># https://www.r-inla.org/download-install</span></span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(INLA)</span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inlabru)</span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a><span class="fu">inla.setOption</span>(<span class="at">inla.mode =</span> <span class="st">'experimental'</span>)</span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a><span class="fu">### Generación grilla espacial y modelo Matern SPDE </span></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r generacion-grilla-inla}</span></span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a>loc <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(datos_sf)</span>
<span id="cb44-473"><a href="#cb44-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-474"><a href="#cb44-474" aria-hidden="true" tabindex="-1"></a>mesh <span class="ot">&lt;-</span> INLA<span class="sc">::</span><span class="fu">inla.mesh.2d</span>(</span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a>  <span class="at">loc =</span> loc,</span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a>  <span class="at">offset =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">4000</span>),</span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">800</span>,</span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a>  <span class="at">max.edge =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="dv">2000</span>),</span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a>  <span class="at">max.n =</span> <span class="dv">10000</span>)</span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_sf) <span class="sc">+</span></span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gg</span>(mesh) <span class="sc">+</span></span>
<span id="cb44-484"><a href="#cb44-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span>
<span id="cb44-485"><a href="#cb44-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a>spde <span class="ot">&lt;-</span> INLA<span class="sc">::</span><span class="fu">inla.spde2.pcmatern</span>(</span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a>  <span class="at">mesh =</span> mesh,</span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior.range =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="fl">0.05</span>),</span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a>  <span class="at">prior.sigma =</span> <span class="fu">c</span>(<span class="dv">200</span>, <span class="fl">0.01</span>)</span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-497"><a href="#cb44-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Ajuste MJB usando INLA sin funciones de inlabru"</span></span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a>proj_obs <span class="ot">&lt;-</span> <span class="fu">inla.mesh.projector</span>(mesh, <span class="at">loc =</span> loc)</span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a>proj_pred <span class="ot">&lt;-</span> <span class="fu">inla.mesh.projector</span>(mesh, <span class="at">loc =</span> mesh<span class="sc">$</span>loc)</span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a>A_obs <span class="ot">&lt;-</span> <span class="fu">inla.spde.make.A</span>(mesh, <span class="at">loc =</span> loc)</span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a>A_pred <span class="ot">&lt;-</span> <span class="fu">inla.spde.make.A</span>(mesh, <span class="at">loc =</span> proj_pred<span class="sc">$</span>loc)</span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>spde<span class="sc">$</span>n.spde</span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a>stack_obs <span class="ot">&lt;-</span></span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inla.stack</span>(</span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">list</span>(<span class="at">y =</span> datos_sf<span class="sc">$</span>TCH),</span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="fu">list</span>(A_obs, <span class="dv">1</span>),</span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a>    <span class="at">effects =</span> <span class="fu">list</span>(<span class="fu">c</span>(</span>
<span id="cb44-513"><a href="#cb44-513" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">1</span>),</span>
<span id="cb44-514"><a href="#cb44-514" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inla.spde.make.index</span>(<span class="st">"spatial"</span>, spde<span class="sc">$</span>n.spde)</span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a>    <span class="at">covar =</span> datos_sf<span class="sc">$</span>ndvi),</span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag =</span> <span class="st">"obs"</span></span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a>stack_pred <span class="ot">&lt;-</span></span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inla.stack</span>(</span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">list</span>(<span class="at">y =</span> <span class="cn">NA</span>),</span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a>    <span class="at">A =</span> <span class="fu">list</span>(A_pred),</span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a>    <span class="at">effects =</span> <span class="fu">list</span>(<span class="fu">c</span>(</span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a>      <span class="fu">list</span>(<span class="at">Intercept =</span> <span class="dv">1</span>),</span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a>      <span class="fu">inla.spde.make.index</span>(<span class="st">"spatial"</span>, mesh<span class="sc">$</span>n)</span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a>    )),</span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a>    <span class="at">tag =</span> <span class="st">"pred"</span></span>
<span id="cb44-528"><a href="#cb44-528" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-529"><a href="#cb44-529" aria-hidden="true" tabindex="-1"></a>stack <span class="ot">&lt;-</span> <span class="fu">inla.stack</span>(stack_obs, stack_pred)</span>
<span id="cb44-530"><a href="#cb44-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a>formula <span class="ot">&lt;-</span> y <span class="sc">~</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> Intercept <span class="sc">+</span> covar <span class="sc">+</span></span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a>    <span class="fu">f</span>(spatial, <span class="at">model =</span> spde)</span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a>result1 <span class="ot">&lt;-</span> <span class="fu">inla</span>(</span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a>  formula,</span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">inla.stack.data</span>(stack_obs, <span class="at">spde =</span> spde),</span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a>  <span class="at">control.predictor =</span> <span class="fu">list</span>(<span class="at">A =</span> <span class="fu">inla.stack.A</span>(stack_obs),</span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a>                           <span class="at">compute =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-542"><a href="#cb44-542" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result1)</span>
<span id="cb44-543"><a href="#cb44-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-544"><a href="#cb44-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-545"><a href="#cb44-545" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datos_sf<span class="sc">$</span>TCH, </span>
<span id="cb44-546"><a href="#cb44-546" aria-hidden="true" tabindex="-1"></a>     result1<span class="sc">$</span>summary.fitted.values[<span class="fu">inla.stack.index</span>(stack_obs, <span class="st">"obs"</span>)<span class="sc">$</span>data, <span class="st">"mean"</span>],</span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Observations vs posterior predicted values at the data locations"</span>)</span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a><span class="co"># field_pred &lt;- inla.mesh.project(proj_pred,</span></span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a><span class="co">#                                 result1$summary.fitted.values[inla.stack.index(stack, "pred")$data, "mean"])</span></span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a><span class="co"># field_pred_sd &lt;- inla.mesh.project(proj_pred,</span></span>
<span id="cb44-553"><a href="#cb44-553" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    result1$summary.fitted.values[inla.stack.index(stack, "pred")$data, "sd"])</span></span>
<span id="cb44-554"><a href="#cb44-554" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a><span class="co"># image(inla.mesh.project(mesh,</span></span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a><span class="co">#                         field = field_pred,</span></span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a><span class="co">#                         dims = c(200, 200)),</span></span>
<span id="cb44-558"><a href="#cb44-558" aria-hidden="true" tabindex="-1"></a><span class="co">#       main = "Posterior field mean")</span></span>
<span id="cb44-559"><a href="#cb44-559" aria-hidden="true" tabindex="-1"></a><span class="co"># image(inla.mesh.project(mesh,</span></span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a><span class="co">#                         field = field_pred_sd,</span></span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a><span class="co">#                         dims = c(200, 200)),</span></span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a><span class="co">#       main = "Prediction standard deviation")</span></span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ajuste de MJB con `inlabru`</span></span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-568"><a href="#cb44-568" aria-hidden="true" tabindex="-1"></a>El paquete <span class="in">`inlabru`</span> fue desarrollado para facilitar la modelación espacial </span>
<span id="cb44-569"><a href="#cb44-569" aria-hidden="true" tabindex="-1"></a>utilizando funciones del paquete <span class="in">`INLA`</span>.</span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-571"><a href="#cb44-571" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ajuste-inlabru}</span></span>
<span id="cb44-572"><a href="#cb44-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: page-right</span></span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-align: center</span></span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a><span class="co">#| </span></span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a>ndvi_bru_spde <span class="ot">&lt;-</span></span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bru</span>(</span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a>    TCH <span class="sc">~</span> <span class="fu">Intercept</span>(<span class="dv">1</span>) <span class="sc">+</span> ndvi <span class="sc">+</span> <span class="fu">site</span>(<span class="at">main =</span> coordinates, <span class="at">model =</span> spde),</span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> <span class="st">"gaussian"</span>,</span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">as_Spatial</span>(datos_sf)</span>
<span id="cb44-580"><a href="#cb44-580" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-581"><a href="#cb44-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ndvi_bru_spde)</span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a><span class="co">#| column: screen-inset-shaded</span></span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-nrow: 1</span></span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ndvi_bru_spde, <span class="st">"Intercept"</span>)</span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ndvi_bru_spde, <span class="st">"ndvi"</span>)</span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Distribución a posteriori de los hiperparámetros</span>
<span id="cb44-596"><a href="#cb44-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"matern.covariance"</span>) <span class="ot">-&gt;</span> covplot</span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"matern.correlation"</span>) <span class="ot">-&gt;</span> corplot</span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"range"</span>) <span class="ot">-&gt;</span> rngplot</span>
<span id="cb44-606"><a href="#cb44-606" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"log.range"</span>) <span class="ot">-&gt;</span> lgrngplot</span>
<span id="cb44-607"><a href="#cb44-607" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"variance"</span>) <span class="ot">-&gt;</span> varplot</span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a><span class="fu">spde.posterior</span>(ndvi_bru_spde, <span class="st">"site"</span>, <span class="at">what =</span> <span class="st">"log.variance"</span>) <span class="ot">-&gt;</span> lgvarplot</span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a><span class="fu">multiplot</span>(<span class="fu">plot</span>(covplot), <span class="fu">plot</span>(corplot),</span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot</span>(rngplot), <span class="fu">plot</span>(lgrngplot),</span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a>          <span class="fu">plot</span>(varplot), <span class="fu">plot</span>(lgvarplot))</span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-616"><a href="#cb44-616" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Observados vs. distribución a posteriori</span></span>
<span id="cb44-617"><a href="#cb44-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-620"><a href="#cb44-620" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-621"><a href="#cb44-621" aria-hidden="true" tabindex="-1"></a>pred_mesh <span class="ot">&lt;-</span></span>
<span id="cb44-622"><a href="#cb44-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(ndvi_bru_spde, <span class="fu">as_Spatial</span>(datos_sf), <span class="sc">~</span> Intercept <span class="sc">+</span> ndvi <span class="sc">+</span> site)</span>
<span id="cb44-623"><a href="#cb44-623" aria-hidden="true" tabindex="-1"></a>predichos <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(pred_mesh)</span>
<span id="cb44-624"><a href="#cb44-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-625"><a href="#cb44-625" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos, <span class="fu">aes</span>(mean, TCH)) <span class="sc">+</span></span>
<span id="cb44-626"><a href="#cb44-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-627"><a href="#cb44-627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span>
<span id="cb44-628"><a href="#cb44-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-629"><a href="#cb44-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-632"><a href="#cb44-632" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-633"><a href="#cb44-633" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb44-634"><a href="#cb44-634" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Predicción espacial de TCH"</span></span>
<span id="cb44-635"><a href="#cb44-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-636"><a href="#cb44-636" aria-hidden="true" tabindex="-1"></a><span class="co"># No aplica para esta aplicación.</span></span>
<span id="cb44-637"><a href="#cb44-637" aria-hidden="true" tabindex="-1"></a><span class="co"># pred_mesh &lt;-</span></span>
<span id="cb44-638"><a href="#cb44-638" aria-hidden="true" tabindex="-1"></a><span class="co">#   predict(ndvi_bru_spde, pixels(mesh), ~ Intercept + ndvi + site)</span></span>
<span id="cb44-639"><a href="#cb44-639" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb44-640"><a href="#cb44-640" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot() +</span></span>
<span id="cb44-641"><a href="#cb44-641" aria-hidden="true" tabindex="-1"></a><span class="co">#   gg(pred_mesh)</span></span>
<span id="cb44-642"><a href="#cb44-642" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(datos_sf) +</span></span>
<span id="cb44-643"><a href="#cb44-643" aria-hidden="true" tabindex="-1"></a><span class="co">#   gg(pred_mesh) +</span></span>
<span id="cb44-644"><a href="#cb44-644" aria-hidden="true" tabindex="-1"></a><span class="co">#   gg(mesh) +</span></span>
<span id="cb44-645"><a href="#cb44-645" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_sf()</span></span>
<span id="cb44-646"><a href="#cb44-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-647"><a href="#cb44-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-648"><a href="#cb44-648" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-649"><a href="#cb44-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-652"><a href="#cb44-652" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-653"><a href="#cb44-653" aria-hidden="true" tabindex="-1"></a>predichos_lm<span class="sc">$</span>pred_ndvi_inla <span class="ot">&lt;-</span> predichos<span class="sc">$</span>mean</span>
<span id="cb44-654"><a href="#cb44-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-655"><a href="#cb44-655" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_iid, TCH)) <span class="sc">+</span></span>
<span id="cb44-656"><a href="#cb44-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-657"><a href="#cb44-657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span>
<span id="cb44-658"><a href="#cb44-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-659"><a href="#cb44-659" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predichos_lm, <span class="fu">aes</span>(pred_ndvi_esp, TCH)) <span class="sc">+</span></span>
<span id="cb44-660"><a href="#cb44-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-661"><a href="#cb44-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>)</span>
<span id="cb44-662"><a href="#cb44-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-663"><a href="#cb44-663" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb44-664"><a href="#cb44-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> predichos_lm, </span>
<span id="cb44-665"><a href="#cb44-665" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(pred_ndvi_iid, TCH, <span class="at">color =</span> <span class="st">'REML iid'</span>)) <span class="sc">+</span></span>
<span id="cb44-666"><a href="#cb44-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> predichos_lm, </span>
<span id="cb44-667"><a href="#cb44-667" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(pred_ndvi_esp, TCH, <span class="at">color =</span> <span class="st">'REML Corr'</span>)) <span class="sc">+</span></span>
<span id="cb44-668"><a href="#cb44-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> predichos_lm, </span>
<span id="cb44-669"><a href="#cb44-669" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(pred_ndvi_inla, TCH, <span class="at">color =</span> <span class="st">'INLA Corr'</span>)) <span class="sc">+</span></span>
<span id="cb44-670"><a href="#cb44-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb44-671"><a href="#cb44-671" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'TCH Predichos'</span>, <span class="at">y =</span> <span class="st">'TCH Observado'</span>, <span class="at">color =</span> <span class="st">'Estimación'</span>)</span>
<span id="cb44-672"><a href="#cb44-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-673"><a href="#cb44-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2022 Pablo Paccioretti, Monica Balzarini, Mariano Córdoba <span xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/">licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY 4.0<img style="height:18px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:18px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a><p></p>
  </span></li>  
</ul>
    </div>
  </div>
</footer>



</body></html>