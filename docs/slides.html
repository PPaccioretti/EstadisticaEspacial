<!DOCTYPE html>
<html lang="es"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.1.251">

  <meta name="author" content="Pablo Paccioretti">
  <title>Modelos Espaciales – slides</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">


<section>
<section id="estimación-frecuentista-y-bayesiana-de-modelos-lineales-para-datos-con-correlación-espacial" class="title-slide slide level1 center">
<h1>Estimación frecuentista y bayesiana de modelos lineales para datos con correlación espacial</h1>
<p>Mónica Balzarini, Pablo Paccioretti</p>
<p>Octubre, 2022</p>
<!-- ## Análisis de datos. Paradigmas -->
<!-- ::: columns -->
<!-- ::: {.column width="47%"} -->
<!-- ### Analítico -->
<!-- -   Fundamentación matemática de los procedimientos estadísticos -->
<!-- -   Resultados muchas veces exactos -->
<!-- -   Expresiones cerradas para medidas de incertidumbre, al menos -->
<!--     asintóticas -->
<!-- -   Teoremas de respaldo, necesidad de supuestos distribucionales -->
<!-- -   Modelos estadísticos -->
<!-- -   -->
<!-- ::: {.column width="6%"} -->
<!-- ::: Clasificación y Predicción -->
<!-- ::: -->
<!-- ::: {.column width="47%"} -->
<!-- ### Computación intensiva -->
<!-- -   Soluciones númericas -->
<!-- -   Resultados aproximados por procesos iterativos -->
<!-- -   Capacidad de modelar situaciones más complejas con supuestos menos -->
<!--     restrictivos -->
<!-- -   Aprendizajes automáticos -->
<!-- -   Más exploratorios que inferenciales -->
<!-- -   Modelos o algoritmos explicativos -->
<!-- -   Clasificación y Predicción -->
<!-- ::: -->
<!-- ::: -->
</section>
<section id="modelo-lineal-general" class="slide level2">
<h2>Modelo Lineal General</h2>
<p><span class="math display">\[Y = Valor\ Esperado + Error\]</span></p>
<p><span class="math display">\[Y = Modelo\ de\ Media + Modelo\ de\ Varianza\ y \ Covarianza\]</span></p>
<p>En el Modelo de Media, la respuesta se relaciona linealmente con regresoras y/o variables de clasificación (Modelos de Regresión, Modelos de ANAVA)</p>
<p>El Modelo de varianzas y covarianzas se determina con supuestos distribucionales para los términos de error:</p>
<div class="columns">
<div class="column" style="width:30%;">
<ul>
<li>i.i.d Normales</li>
<li>no correlacionados</li>
<li>varianza constante</li>
</ul>
</div><div class="column" style="width:70%;">
<div class="fragment fade-in-then-out">
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Hay alternativas para corregir la falta de cumplimiento de algunos de estos supuestos.</p>
</div>
</div>
</div>
<div class="callout callout-caution callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>El cumplimiento de los supuestos no son necesarios para la estimación pero sí para la inferencia, esto significa que el valor-p puede no ser real en caso de incumplimiento de estos.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="modelo-de-regresión-lineal" class="slide level2">
<h2>Modelo de Regresión Lineal</h2>
<p><span class="math display">\[Y_{ij} = \beta_0 + \beta_1 x_{ij}+\varepsilon_{ij}\]</span></p>
<p><span class="math display">\[\varepsilon_{ij} \sim N \big(0, \sigma^2 \big) \: \: \:
cov(\varepsilon_{ij}, \varepsilon_{i^{\prime} j^{\prime}}) = 0 \: \forall ij \neq i^{\prime} j^{\prime}\]</span></p>
<p>Donde:</p>
<ul>
<li><span class="math inline">\(Y_{ij}\)</span> es la observación en la <span class="math inline">\(j-ésima\)</span> repetición de la <span class="math inline">\(i-ésima\)</span> variable explicativa.</li>
<li><span class="math inline">\(\beta_0\)</span> es un término constante o intercepto</li>
<li><span class="math inline">\(\beta_1\)</span> es el efecto de la variable explicativa</li>
<li><span class="math inline">\(x_{ij}\)</span> es el valor de la <span class="math inline">\(j-ésima\)</span> repetición de la <span class="math inline">\(i-ésima\)</span> variable explicativa.</li>
<li><span class="math inline">\(\varepsilon_{ij}\)</span> es un efecto aleatorio o término de error asociado a la observación <span class="math inline">\(Y_{ij}\)</span></li>
</ul>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Alternativamente la covarianza entre los términos de error puede ser distinta de cero, por ejemplo covarianza positiva expresada como función de la distancia entre observaciones</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="modelo-lineal-mixto" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Modelo Lineal Mixto</h1>

</section>
<section id="modelo-lineal-mixto-1" class="slide level2">
<h2>Modelo Lineal Mixto</h2>
<h3 id="permite-estimar-un-modelo-para-respuestas-normales-sin-que-se-cumpla-el-supuesto-de-independencia-yo-de-homogeneidad-de-varianzas">Permite estimar un modelo para respuestas normales sin que se cumpla el supuesto de independencia y/o de homogeneidad de varianzas</h3>
<p>La respuesta se modela como función de variables explicativas de efectos fijos y de efectos aleatorios.</p>
<p>La correlación se puede abordar de dos formas:</p>
<ol type="1">
<li>Especificando correlaciones entre los términos de error</li>
<li>Incorporando efectos aleatorios que inducen correlaciones entre los datos que comparten el mismo nivel del efecto</li>
</ol>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>La correlación entre los errores se especifica como función de la distancia espacial entre las observaciones (por ej. correlación espacial exponencial o esférica como modelos para la caída de las correlaciones a medida que aumenta la distancia entre observaciones)</p>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-mixto.-efectos-fijos-vs.-aleatorios" class="slide level2">
<h2>Modelo Lineal Mixto. Efectos Fijos vs.&nbsp;Aleatorios</h2>
<ul>
<li>Niveles arbitrariamente determinados vs.&nbsp;muestra aleatoria de niveles (asociado a una distribución de probabilidad)</li>
<li>Mecanismos de colección</li>
<li>Espacio de inferencia</li>
<li>Estrategia de modelación</li>
<li>Cantidad de niveles</li>
<li>Calidad de la estimación de componentes de varianza</li>
<li>Cómputo de covarianzas</li>
</ul>
</section>
<section id="modelo-lineal-mixto-modelo-jerárquico-normal" class="slide level2">
<h2>Modelo Lineal Mixto = Modelo Jerárquico Normal</h2>
<p>Un modelo jerárquico es un modelo especificado en etapas.</p>
<p><em>Ejemplo</em>: Modelo lineal mixto con efectos aleatorios <span class="math inline">\(u\)</span>.</p>
<p><span class="math display">\[y \vert \beta, u, \sigma^2 \sim N(x^{\prime} \beta + z^{\prime}u, \sigma^2I) \\
u \sim N(0, D(\theta))\]</span></p>
</section></section>
<section>
<section id="modelo-lineal-generalizado" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Modelo Lineal Generalizado</h1>

</section>
<section id="modelo-lineal-generalizado.-componentes" class="slide level2">
<h2>Modelo Lineal Generalizado. Componentes</h2>
<ol type="1">
<li>Distribución de las observaciones
<ul>
<li>No necesariamente normal, no asume homogeneidad de varianzas</li>
</ul></li>
<li>Predictor lineal
<ul>
<li>Combinación lineal del efecto de las fuentes de variación más un intercepto</li>
</ul></li>
<li>Función de enlace
<ul>
<li>Permite ajustar un modelo lineal a la media de la respuesta. Cuando estimamos los parámetros del modelo lineal, lo hacemos en la escala de la función de enlace. Su inversa nos da el valor predicho en la escala de las observaciones</li>
</ul></li>
</ol>
</section>
<section id="modelo-lineal-generalizado-1" class="slide level2">
<h2>Modelo Lineal Generalizado</h2>
<ul>
<li>Lineal
<ul>
<li>Una transformación de la media (valor esperado de la respuesta) se relaciona linealmente con las fuentes de variación reconocidas a priori</li>
<li>Predictor lineal de una función de la esperanza o media de <span class="math inline">\(Y\)</span>, <span class="math inline">\(E(Y)\)</span></li>
</ul></li>
<li>Generalizado
<ul>
<li>La componente aleatoria puede ser no-normal (distribución miembro de la familia exponencial como es el caso de Bernouille, Binomial y Poisson para modelar presencia/ausencia, proporciones y conteos respectivamente y el caso de distribuciones continuas: Normal, Gamma, Inversa Gaussiana)</li>
</ul></li>
</ul>
</section></section>
<section>
<section id="modelo-lineal-generalizado-mixto" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Modelo Lineal Generalizado Mixto</h1>

</section>
<section id="modelo-lineal-generalizado-mixto-glmm" class="slide level2">
<h2>Modelo Lineal Generalizado Mixto (GLMM)</h2>
<p>No necesariamente normal, no-homogeneidad y no independencia</p>
<p>MLGM permite trabajar datos no normales (por ejemplo variables binarias y conteos) y correlaciones, a través de la incorporación de efectos aleatorios. Es un modelo Jerárquico</p>
</section></section>
<section>
<section id="paradigmas-de-estimaciónpredicción" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Paradigmas de estimación/predicción</h1>

</section>
<section class="slide level2">

<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Frecuentista</strong></p>
<p>Relacionan la variable respuesta con variables explicativas a través de parámetros desconocidos. Los parámetros son constantes que se estiman con determinada confianza.</p>
</div><div class="column" style="width:50%;">
<p><strong>Bayesiano</strong></p>
<p>Relacionan la variable dependiente con variables explicativas a través de parámetros desconocidos. Los parámetros se interpretan en término de probabilidades bayesianas; se supone una distribución “a priori” para cada parámetro y se deriva la distribución “a posteriori” de cada parámetro y para la predicción de Y.</p>
</div>
</div>
</section></section>
<section>
<section id="modelos-mixtos-o-multinivel-estimación-frecuentista" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Modelos Mixtos (o Multinivel): estimación frecuentista</h1>

</section>
<section id="modelo-jerárquico-normal" class="slide level2">
<h2>Modelo Jerárquico Normal</h2>
<p>Se utiliza Máxima Verosimilitud (ML) o Máxima Verosimilitud Restringida (REML).</p>
<p>Se estiman los parámetros de la estructura de media (coeficientes de regresión) y los parámetros de varianza y covarianza asociados a los términos de error (varianza nugget, varianza del proceso con datos independientes y rango).</p>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Los errores estándares se ajustan por correlación espacial.</p>
</div>
</div>
</div>
<div class="callout callout-warning callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Con muchos datos, la computación de distancias y de la verosimilitud es costosa. Se deben usar otros métodos de estimación.</p>
</div>
</div>
</div>
</section>
<section id="modelo-jerárquico-bayesiano" class="slide level2">
<h2>Modelo Jerárquico Bayesiano</h2>
<ul>
<li>Los parámetros se interpretan en término de probabilidades bayesianas; se supone una distribución “a priori” para cada parámetro y se deriva la distribución “a posteriori” de cada parámetro.</li>
<li>La media, moda o mediana de la distribución a posteriori se usa como proxy del parámetro.</li>
<li>Las “a priori” son parte del modelo y una manera de expresar la distribución de probabilidad de los datos dados los parámetros.</li>
<li>Los parámetros de las distribuciones “a priori” se llaman hiperparámetros.</li>
<li>“a posteriori” = actualización de la “a priori” con los datos observados.</li>
<li>Permite otorgar grado de creencia (intervalo de credibilidad)</li>
</ul>
</section>
<section id="pensando-en-términos-de-intervalos-de-credibilidad" class="slide level2">
<h2>Pensando en términos de Intervalos de credibilidad</h2>
<ul>
<li><p>La información previa sobre los parámetros se resumen en distribuciones de probabilidad (distribuciones a priori) a partir de las cuales se estima la distribución de probabilidad a posteriori dadas las observaciones.</p></li>
<li><p>La estimaciones puntuales de los parámetros de interés se obtienen calculando medidas resumen de la distribución a posteriori.</p></li>
<li><p>Se informan intervalos de credibilidad calculados desde percentiles de la distribución a posteriori.</p></li>
<li><p>La credibilidad se interpreta como la probabilidad de que el valor estimado para el parámetro pertenezca al intervalo reportado, dado los datos observados</p></li>
</ul>
</section>
<section id="por-qué-jerárquico" class="slide level2">
<h2>¿Por qué Jerárquico?</h2>
<p>Los datos <span class="math inline">\(Z\)</span> tienen una distribución condicional dado el proceso latente que los ha generado <span class="math inline">\(Y\)</span>, que a su vez tiene una distribución condicional a ciertos parámetros <span class="math inline">\(\theta\)</span> y <span class="math inline">\(\theta\)</span> tiene a su vez una distribución “a priori”.</p>
<table style="width:99%;">
<colgroup>
<col style="width: 40%">
<col style="width: 58%">
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;"><p>Modelo para los datos</p>
<p>Modelo para el proceso</p>
<p>Modelo para los parámetros</p></td>
<td style="text-align: left;"><p><span class="math inline">\(\left[ Z \big\vert Y, \theta \right]\)</span></p>
<p><span class="math inline">\(\left[ Y \big\vert \theta \right]\)</span></p>
<p><span class="math inline">\(\left[ \theta \right]\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="modelo-jerárquico-bayesiano-1" class="slide level2">
<h2>Modelo Jerárquico Bayesiano</h2>
<p>En un modelo bayesiano, los parámetros se consideran variables aleatorias y tienen distribuciones a priori. Continuando con el ejemplo anterior:</p>
<p><span class="math display">\[\beta \sim \pi (\beta)\]</span></p>
<p>En el modelo jerárquico bayesiano, los parámetros de las distribuciones a priori de los parámetros (llamados <em>hiperparámetros</em>) también se consideran variables aleatorias, y también tienen ditribuciones a priori.</p>
<p><span class="math display">\[\sigma^2 \sim \pi (\sigma^2)\]</span></p>
</section>
<section id="modelo-gausiano-latente-una-clase-de-mjb" class="slide level2">
<h2>Modelo Gausiano Latente (una clase de MJB)</h2>
<p>El predictor lineal contiene el intercepto, los efectos de las covariables y funciones desconocidas <span class="math inline">\(f^{(k)}\)</span> que incluyen los efectos aleatorios:</p>
<p><span class="math display">\[\eta_i = \mu + \sum_{j}{\beta_j z_{ij}} + \sum_{k}{f^{(k)}u_{ik}}\]</span></p>
<p>Los componentes del predictor lineal forman un campo latente <span class="math inline">\(x=(\eta, \mu, \beta, f)\)</span>. Además de los parámetros de la verosimilitud, también habrá hiperparámetros <span class="math inline">\(\theta\)</span>. En un MLG, todos los componentes del predictor lineal deben tener distribuciones a priori gausianas, pero <span class="math inline">\(\theta\)</span> puede tener distribuciones a priori no gausianas.</p>
<p>El MLG se puede escribir formalmente como:</p>
<p><span class="math display">\[y \vert x, \theta \sim \prod \pi (y_i \vert \eta_i, \theta) \\
x \vert \theta \sim N(0, Q^{-1}(\theta)) \\
\theta \sim \pi(\theta)\]</span></p>
</section>
<section id="por-qué-inla" class="slide level2">
<h2>¿Por qué INLA?</h2>
<p>Las distribuciones a posteriori de los modelos bayesianos no suelen estar disponibles analíticamente y usualmente se encuentran con métodos de simulación por cadenas de Markov Monte Carlo (MCMC) (Besag et al., 1995). Estos métodos han permitido resolver modelos complejos sin la necesidad de imponer estructuras que lo simplifiquen. Pero, el método MCMC conlleva alta demanda computacional. Rue et al (2009) propusieron una alternativa para aproximar la distribución a posteriori en contextos de datos espaciales. La simplificación se produce por el supuesto de existencia de un campo aleatorio gaussiano markoviano (las correlaciones espaciales sólo dependen de los sitios en el vecindario).</p>
<p>INLA (<em>Integrated Nested Laplace Approximations</em>; Rue, Martino y Chopin, 2009) es un método que permite estimar la distribución marginal a posteriori de los parámetros. INLA permite la inferencia bayesiana de los Modelos Gaussianos Latentes.</p>
</section>
<section id="estimación-vía-inla" class="slide level2">
<h2>Estimación vía INLA</h2>
<p>INLA es más rápido que MCMC porque el campo latente al que referencia es un campo aleatorio gaussiano de Markov (GMRF) y por tanto tiene matriz de precisión rala, lo que permite a INLA utilizar métodos numéricos para matrices ralas, que son más eficientes.</p>
<p>La estimación de INLA requiere la construcción de una grilla espacial (mesh). La grilla es una colección de elementos geométricos (trángulos) que divide el espacio dimensional que contiene los sitios con observaciones a partir de la cual se estima la dependencia espacial de la variable respuesta.</p>
<p>La estimación de las covarianzas de los efectos de sitio se hacen a través de funciones de suavizado impuestas sobre la grilla espacial. La aproximación SPDE (<em>Stochastic Partial Differential Equation</em>), agiliza el cómputo ya que la solución se presenta como una matriz de covarianza de Mátern.</p>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>INLA puede ser usado para estimar modelo jerárquicos para datos espaciales con variable de respuesta normal, binaria, binomial, conteos, es decir, en el contexto de Modelos Lineales Generalizados Mixtos</p>
</div>
</div>
</div>
</section></section>
<section>
<section id="ilustración" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Ilustración</h1>

</section>
<section id="modelo-lineal-mixto-iid-para-látice-estimado-vía-inla" class="slide level2">
<h2>Modelo Lineal Mixto iid para látice estimado vía INLA</h2>
<p>Se tiene una respuesta continua ESPI (Ecosystem Services Provisioning Index) observada en el territorio de la Cuenca del Carcarañá. El territorio está dividido en 4676 unidades de área de 1400 Has. cada una. Se dispone además de la covariable “Porcentaje de Pasturas Naturales Manejadas” en cada unidad de área.</p>
<div class="columns">
<div class="column" style="width:47%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/01_espiobs.jpg"></p>
<p></p><figcaption>Mapa de ESPI observado</figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:3%;">

</div><div class="column" style="width:50%;">
<div style="font-size: 0.7em">
<table>
<thead>
<tr class="header">
<th>Región</th>
<th>ESPI</th>
<th style="text-align: center;">%PasturaNaturalManejada</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>2.11</td>
<td style="text-align: center;">1.90</td>
</tr>
<tr class="even">
<td>2</td>
<td>1.35</td>
<td style="text-align: center;">0.20</td>
</tr>
<tr class="odd">
<td>3</td>
<td>1.84</td>
<td style="text-align: center;">19.33</td>
</tr>
<tr class="even">
<td>4</td>
<td>2.04</td>
<td style="text-align: center;">60.08</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td style="text-align: center;">…</td>
</tr>
<tr class="even">
<td>4676</td>
<td>2.13</td>
<td style="text-align: center;">62.57</td>
</tr>
</tbody>
</table>
</div>
<div class="columns">
<div class="column" style="width:40%;">
<ul>
<li>Min: 0.088</li>
<li>Media: 1.84</li>
<li>DE: 0.287</li>
<li>Max: 3</li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/02_espiHist.png"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-iid-para-látice-estimado-vía-inla-1" class="slide level2">
<h2>Modelo Lineal Mixto iid para látice estimado vía INLA</h2>
<p>Vamos a modelar el ESPI en función del porcentaje de pasturas en cada región <span class="math inline">\(i\)</span> utilizando una regresión lineal bayesiana con efectos aleatorios de sitio <em>iid</em></p>
<p><span class="math display">\[y_i \sim N \big(\mu, \tau_{\varepsilon}^{-1} \big)\]</span></p>
<p><span class="math display">\[E \left[ y_i \right] = \beta_0 + \beta_1 \times Porc.Pasturas_i + \mu_i\]</span></p>
<p><span class="math display">\[u_i \sim i.i.d \ N \big(0, \tau_{u}^{-1} \big)\]</span></p>
<p>En la regresión bayesiana, los parámetros <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> tienen distribuciones a priori y en el jerárquico bayesiano, los hiperparámetros <span class="math inline">\(\tau_{\varepsilon}^{-1}\)</span> y <span class="math inline">\(\tau_{\mu}^{-1}\)</span> también.</p>
<p>Por defecto, <code>INLA</code> asigna distribuciones a priori <strong>no informativas</strong> <span class="math inline">\(N(0, 10e^5)\)</span> para <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>, y <span class="math inline">\(Gamma(0, 10e^5)\)</span> para <span class="math inline">\(\tau_{\varepsilon}^{-1}\)</span> y <span class="math inline">\(\tau_{u}^{-1}\)</span></p>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Como sólo se tiene un nivel de observaciones y la respuesta es gaussiana, agregar efectos iid solo equivale a redistribuir la varianza entre el efecto aleatorio y el error de las observaciones.</p>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-iid-para-látice-estimado-vía-inla-2" class="slide level2">
<h2>Modelo Lineal Mixto iid para látice estimado vía INLA</h2>
<p>Corremos el modelo en <code>INLA</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" data-code-line-numbers="false"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">inla</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> ESPI <span class="sc">~</span> porcentaje_pasturas <span class="sc">+</span> <span class="fu">f</span>(id_region, <span class="at">model =</span> <span class="st">'iid'</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">'gaussian'</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>, <span class="at">waic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Al efecto aleatorio iid lo incluimos en la fórmula con <code>f(id_region, model = 'iid')</code>.</p>
<p>Con <code>control.compute</code> le pedimos a <code>INLA</code> que calcule los criterios de información DIC y WAIC (menores = mejores).</p>
</section>
<section id="modelo-lineal-mixto-iid-para-látice-estimado-vía-inla-3" class="slide level2">
<h2>Modelo Lineal Mixto iid para látice estimado vía INLA</h2>
<p>Distribuciones a posteriori de los coeficientes de regresión:</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/03_distparam.png"></p>
</figure>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/04_disInter.png"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/05_DistPast.png"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-iid-para-látice-estimado-vía-inla-4" class="slide level2">
<h2>Modelo Lineal Mixto iid para látice estimado vía INLA</h2>
<p>Distribuciones a posteriori para los hiperparámetros (escala de precisión <span class="math inline">\(\tau\)</span>)</p>
<p><img data-src="img/06_disHiper.png"></p>
<div class="columns">
<div class="column" style="width:30%;">
<p>Gráfico en la escala de la desviación estándar <span class="math inline">\(\sigma\)</span></p>
<p><span class="math display">\[\sigma^2 = \frac{1}{\tau}\]</span></p>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/06_distribGrafHiper.png"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-iid-para-látice-estimado-vía-inla-5" class="slide level2">
<h2>Modelo Lineal Mixto iid para látice estimado vía INLA</h2>
<p>Gráficos con los predichos y las observaciones, calculando el predicho puntual como la moda de la distribución a posteriori de los predichos:</p>
<div style="font-size: 0.7em; text-align: center">
<p>DIC: 88 | WAIC: -43</p>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/07_predichos.jpg"></p>
<p></p><figcaption>Predichos puntuales</figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/08_observados.jpg"></p>
<p></p><figcaption>Observaciones</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-icar-para-látice-estimado-vía-inla" class="slide level2">
<h2>Modelo Lineal Mixto ICAR para látice estimado vía INLA</h2>
<p>En vez de utilizar efectos aleatorios normales e idéndticamente distribuídos, podríamos utilizar efectos aleatorios con estructura espacial explícita.</p>
<p>Un ejemplo clásico apra datos areales son los efectos con estructura <em>Intrinsic Conditional Autoregressive</em> o ICAR (Besag, 1974):</p>
<p><span class="math display">\[u_i \vert u_{-1} \sim N \Big( \frac{1}{N_1} \sum_{j=1}^{n} a_{ij} u_j, \frac{1}{\tau_u N_i} \Big)\]</span></p>
<p>donde <span class="math inline">\(a_{ij} \ne 0\)</span> si y solo si las áreas <span class="math inline">\(i\)</span> y <span class="math inline">\(j\)</span> son vecinas, <span class="math inline">\(N_i\)</span> es la cantidad de áreas vecinas del área <span class="math inline">\(i\)</span>, <span class="math inline">\(u_{-1}\)</span> se asume <span class="math inline">\(\sum_{j=1}^{n} u_i = 0\)</span></p>
<p>Hay distintas maneras de definir cuándo dos áreas son vecinas y qué peso tomará <span class="math inline">\(a_{ij}\)</span> cuando lo son. Por ejemplo, podríamos tomar que son vecinas cuando se tocan al menos en un punto, y que <span class="math inline">\(a_{ij} = 1\)</span> cuando son vecinas.</p>
</section>
<section id="modelo-lineal-mixto-icar-para-látice-estimado-vía-inla-1" class="slide level2">
<h2>Modelo Lineal Mixto ICAR para látice estimado vía INLA</h2>
<p>Vamos a modelar el ESPI en función del porcentaje de pasturas en cada región <span class="math inline">\(i\)</span> utilizando una regresión lineal bayesiana con efectos aleatorios espaciales ICAR:</p>
<p><span class="math display">\[y_i \sim N \big(\mu, \sigma_{\varepsilon}^{-2} \big)\]</span></p>
<p><span class="math display">\[E \left[ y_i \right] = \beta_0 + \beta_1 \times Porc.Pasturas_i + u_i\]</span></p>
<p><span class="math display">\[u_i \vert u_{-1} \sim N \Big( \frac{1}{N_1} \sum_{j=1}^{n} a_{ij} u_j, \frac{1}{\tau_u N_i} \Big)\]</span></p>
</section>
<section id="modelo-lineal-mixto-icar-para-látice-estimado-vía-inla-2" class="slide level2">
<h2>Modelo Lineal Mixto ICAR para látice estimado vía INLA</h2>
<p>Definimos un grafo con los vecindarios de cada región:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" data-code-line-numbers="false"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>adj <span class="ot">&lt;-</span> <span class="fu">poly2nb</span>(data)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>vecindario <span class="ot">&lt;-</span> <span class="fu">nb2mat</span>(adj, <span class="at">style =</span> <span class="st">"W"</span>, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Corremos el modelo en <code>INLA</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" data-code-line-numbers="false"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">inla</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> ESPI <span class="sc">~</span> porcentaje_pasturas <span class="sc">+</span> <span class="fu">f</span>(id_region, <span class="at">model =</span> <span class="st">'icar'</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">graph =</span> vecindario),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">'gaussian'</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">control.compute =</span> <span class="fu">list</span>(<span class="at">dic =</span> <span class="cn">TRUE</span>, <span class="at">waic =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Le pasamos el grafo al modelo en <code>f(…, graph = vecindario)</code>.</p>
</section>
<section id="modelo-lineal-mixto-icar-para-látice-estimado-vía-inla-3" class="slide level2">
<h2>Modelo Lineal Mixto ICAR para látice estimado vía INLA</h2>
<p>Distribuciones a posteriori de los coeficientes de regresión:</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/09_DistrCoeficarTabla.png"></p>
</figure>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/10_distribGrafHiper.png"></p>
</figure>
</div>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/11_distribGrafHiper.png"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-icar-para-látice-estimado-vía-inla-4" class="slide level2">
<h2>Modelo Lineal Mixto ICAR para látice estimado vía INLA</h2>
<p>Distribuciones a posteriori para los hiperparámetros (escala de precisión <span class="math inline">\(\tau\)</span>)</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/12_DistrCoeficarTabla.png"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/13_sdHiper.png"></p>
</figure>
</div>
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>El desvio estandar del efecto aleatorio podría tener mayor magnitud que el desvío estándar del ESPI observado, que era 0.287.</p>
</div>
</div>
</div>
</section>
<section id="modelo-lineal-mixto-icar-para-látice-estimado-vía-inla-5" class="slide level2">
<h2>Modelo Lineal Mixto ICAR para látice estimado vía INLA</h2>
<p>Gráficos con los predichos y las observaciones, calculando el predicho puntual como la moda de la distribución a posteriori de los predichos:</p>
<div style="font-size: 0.7em; text-align: center">
<p>DIC: -3783 | WAIC: -3862</p>
</div>
<div class="columns">
<div class="column" style="width:49%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/14_predichosicar.jpg"></p>
<p></p><figcaption>Predichos puntuales</figcaption><p></p>
</figure>
</div>
</div><div class="column" style="width:49%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/08_observados.jpg"></p>
<p></p><figcaption>Observaciones</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comentarios" class="slide level2">
<h2>Comentarios</h2>
<p>Entre estos ajustes, el modelo ICAR proporcionó menores DIC y WAIC. Ademas, en los mapas de predichos se observa que el ICAR logra captar el detalle de las regiones con ESPI bajo, algo que el iid no logró.</p>
<p>En un modelo con efecto aleatorio de sitio y efecto aleatorio residual separables podrían usarse distintos modelos para los distintos efectos aleatorios. Por ejemplo ICAR para el efecto sitio e i.i.d para el residual</p>
</section></section>
<section id="modelo-lineal-mixto-para-datos-contínuos-estimado-vía-reml-e-inla" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Modelo Lineal Mixto para datos contínuos estimado vía REML e INLA</h1>

</section>

<section>
<section id="modelo-lineal-mixto-para-datos-de-conteo-estimado-vía-inla" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Modelo Lineal Mixto para datos de conteo estimado vía INLA</h1>

</section>
<section id="ejemplo-mjb-datos-de-conteo" class="slide level2">
<h2>Ejemplo MJB datos de conteo</h2>
<p><span class="math display">\[Y_i \sim Poisson(\theta_i) \ \ \ \ i = 1, \dots, n\]</span></p>
<p><span class="math display">\[log(\theta_i) = \beta_0 + \beta_1 \times x_i + \dots + u_i + \nu_i\]</span></p>
<p><span class="math display">\[u_i \vert u_{-i} \sim N \Bigg( \bar{u}_{\delta_i}, \frac{\sigma_{u}^{2}}{\eta_{\delta_i}} \Bigg) \]</span></p>
<p><span class="math display">\[\nu \sim N(0,\sigma_{\nu}^2)\]</span> Tasa estandarizada de incidencia (SIR) <span class="math display">\[SIR_i = \frac{Y_i}{E_i}\]</span></p>
<div class="callout callout-note callout-captioned callout-style-default">
<div class="callout-body">
<div class="callout-caption">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Riesgo Relativo (RR) con datos espaciales</strong></p>
</div>
<div class="callout-content">
<p>Relación entre la probabilidad de que ocurra el evento en el sitio y la probabilidad de que el mismo evento ocurra en otro sitio.</p>
</div>
</div>
</div>
</section></section>
<section id="ejemplos-de-aplicación" class="title-slide slide level1 center" data-background-color="#546e7a">
<h1>Ejemplos de aplicación</h1>
<p><a href="Ej01.html" data-preview-link="true">Ejercicios 1</a></p>
<p><a href="Ej02.html" data-preview-link="true">Ejercicios 2</a></p>
</section>

<section id="gracias" class="title-slide slide level1 center">
<h1>Gracias!</h1>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/multiplex/socket.io.js"></script>
  <script src="site_libs/revealjs/plugin/multiplex/multiplex.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"theme":"chalkboard","chalkEffect":0},
'multiplex': {"secret":null,"id":"11e3d2a74f4a9e9c","url":"https://reveal-multiplex.glitch.me/"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copiada");
        setTimeout(function() {
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto-reveal',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const cites = ref.parentNode.getAttribute('data-cites').split(' ');
        tippyHover(ref, function() {
          var popup = window.document.createElement('div');
          cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    });
    </script>
    

</body></html>